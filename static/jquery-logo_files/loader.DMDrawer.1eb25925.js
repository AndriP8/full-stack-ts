(window.webpackJsonp=window.webpackJsonp||[]).push([[171],{"+Bsv":function(e,t,a){"use strict";var n=a("ERkP"),s=a.n(n),r=a("3XMw"),l=a.n(r),i=a("M2x3"),o="settingsAppBar",c=a("/yvb"),d=a("rHpw");const u=l.a.bb081ea1,h={viewType:"settings_button"},p=s.a.memo((({onPress:e,pullRight:t,to:a})=>s.a.createElement(c.a,{accessibilityLabel:u,behavioralEventContext:h,hoverLabel:{label:u},icon:s.a.createElement(i.a,null),link:a,onPress:e,pullRight:t,style:m.button,testID:o,type:"primaryText"}))),m=d.a.create((e=>({button:{marginVertical:`calc(-${e.spaces.space12})`}})));t.a=p},"23An":function(e,t,a){"use strict";var n=a("ERkP"),s=n.useEffect,r=n.useRef;e.exports=function(){var e=r(!0);return s((function(){return e.current=!0,function(){e.current=!1}}),[]),e}},"9SqB":function(e,t,a){"use strict";var n=a("IGGJ")(a("yiKp")),s=a("ERkP"),r=a("Ud88"),l=a("K1lQ").commitMutation,i=s.useState,o=s.useEffect,c=s.useRef,d=s.useCallback,u=a("23An");e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,a=r(),s=u(),h=c(a),p=c(e),m=c(new Set),g=i(!1),b=g[0],_=g[1],y=d((function(t){h.current===a&&p.current===e&&(m.current.delete(t),s.current&&_(m.current.size>0))}),[a,s,e]);o((function(){h.current===a&&p.current===e||(m.current=new Set,s.current&&_(!1),h.current=a,p.current=e)}),[a,s,e]);var v=d((function(r){var l=t(a,(0,n.default)((0,n.default)({},r),{},{mutation:e,onCompleted:function(e,t){y(l),r.onCompleted&&r.onCompleted(e,t)},onError:function(e){y(l),r.onError&&r.onError(e)},onUnsubscribe:function(){y(l),r.onUnsubscribe&&r.onUnsubscribe()}}));return m.current.add(l),s.current&&_(!0),l}),[y,t,a,s,e]);return[v,b]}},Avzu:function(e,t,a){"use strict";var n=a("ERkP"),s=a.n(n),r=a("Lsrn"),l=a("k/Ka");const i=(e={})=>Object(l.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[r.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M23.25 3.25h-2.425V.825c0-.414-.336-.75-.75-.75s-.75.336-.75.75V3.25H16.9c-.414 0-.75.336-.75.75s.336.75.75.75h2.425v2.425c0 .414.336.75.75.75s.75-.336.75-.75V4.75h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-3.175 6.876c-.414 0-.75.336-.75.75v8.078c0 .414-.337.75-.75.75H4.095c-.412 0-.75-.336-.75-.75V8.298l6.778 4.518c.368.246.79.37 1.213.37.422 0 .844-.124 1.212-.37l4.53-3.013c.336-.223.428-.676.204-1.012-.223-.332-.675-.425-1.012-.2l-4.53 3.014c-.246.162-.563.163-.808 0l-7.586-5.06V5.5c0-.414.337-.75.75-.75h9.094c.414 0 .75-.336.75-.75s-.336-.75-.75-.75H4.096c-1.24 0-2.25 1.01-2.25 2.25v13.455c0 1.24 1.01 2.25 2.25 2.25h14.48c1.24 0 2.25-1.01 2.25-2.25v-8.078c0-.415-.337-.75-.75-.75z"})));i.metadata={width:24,height:24},t.a=i},DbJc:function(e,t,a){"use strict";var n=a("VPAj");const s={...a("7n04").a,initialScrollHeadroom:Object(n.a)(0),scrollHeadroom:Object(n.a)(0),pinToNewestWhenAtNewest:!0};t.a=s},IpT4:function(e,t,a){"use strict";var n=a("ERkP"),s=a.n(n),r=a("Lsrn"),l=a("k/Ka");const i=(e={})=>Object(l.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[r.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M22.238 2.257c-.293-.293-.768-.293-1.06 0L2.52 20.917c-.293.292-.293.767 0 1.06.146.146.338.22.53.22s.384-.073.53-.22l18.658-18.66c.293-.293.293-.767 0-1.06zM2.986 17.82c.155 0 .312-.048.446-.148.112-.083 2.752-2.104 2.708-7.248-.02-2.16.643-3.98 1.913-5.266 1.093-1.107 2.577-1.72 4.18-1.727 1.325.006 2.562.42 3.578 1.195.137.104.297.153.455.153.227 0 .45-.102.598-.295.25-.33.188-.8-.142-1.052-1.278-.975-2.828-1.493-4.483-1.5h-.003c-2.008.008-3.87.78-5.248 2.173-1.536 1.551-2.368 3.8-2.348 6.332.037 4.33-2.02 5.967-2.103 6.03-.332.247-.4.718-.154 1.05.147.2.374.303.603.303zm16.844-7.382c.002-.246-.003-.487-.017-.723-.024-.414-.387-.74-.792-.706-.413.023-.728.378-.705.79.012.205.017.413.015.624-.024 2.868.785 4.765 1.526 5.896h-8.314c-.414 0-.75.336-.75.75s.336.75.75.75h3.522c-.1 1.48-1.323 2.66-2.828 2.66-1.003 0-1.913-.514-2.436-1.372-.214-.354-.675-.467-1.03-.25-.354.214-.467.675-.25 1.03.795 1.31 2.185 2.09 3.716 2.09 2.332 0 4.227-1.85 4.328-4.158h4.922c.32 0 .604-.206.707-.51.104-.305 0-.643-.255-.84-.087-.066-2.145-1.7-2.108-6.032z"})));i.metadata={width:24,height:24},t.a=i},"ShJ/":function(e,t,a){"use strict";var n=a("ERkP"),s=a.n(n),r=a("Lsrn"),l=a("k/Ka");const i=(e={})=>Object(l.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[r.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M20.472 14.738c-.388-1.808-2.24-3.517-3.908-4.246l-.474-4.307 1.344-2.016c.258-.387.28-.88.062-1.286-.218-.406-.64-.66-1.102-.66H7.54c-.46 0-.884.254-1.1.66-.22.407-.197.9.06 1.284l1.35 2.025-.42 4.3c-1.667.732-3.515 2.44-3.896 4.222-.066.267-.043.672.222 1.01.14.178.46.474 1.06.474h3.858l2.638 6.1c.12.273.39.45.688.45s.57-.177.688-.45l2.638-6.1h3.86c.6 0 .92-.297 1.058-.474.265-.34.288-.745.228-.988zM12 20.11l-1.692-3.912h3.384L12 20.11zm-6.896-5.413c.456-1.166 1.904-2.506 3.265-2.96l.46-.153.566-5.777-1.39-2.082h7.922l-1.39 2.08.637 5.78.456.153c1.355.45 2.796 1.78 3.264 2.96H5.104z"})));i.metadata={width:24,height:24},t.a=i},X8um:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:s=[{defaultValue:null,kind:"LocalArgument",name:"label"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxQuery",selections:[{alias:"labeled_conversation_slice",args:r=[{kind:"Variable",name:"label",variableName:"label"},{kind:"Literal",name:"s",value:18}],concreteType:"DMLabeledConversationsSlice",kind:"LinkedField",name:"__DMPinnedInboxQuery_labeled_conversation_slice_slice",plural:!1,selections:[{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"items",plural:!0,selections:[l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[o={alias:null,args:null,kind:"ScalarField",name:"conversation_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[o,c={alias:null,args:null,kind:"ScalarField",name:"conversation_type",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"created_at_millis",storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[l,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[h={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"original_img_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_height",storageKey:null}],type:"ApiImage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[l,i,p={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id_str",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"screen_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profile_image_url_https",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},m={alias:null,args:null,concreteType:"PerspectivalConversationMetadata",kind:"LinkedField",name:"perspectival_conversation_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"last_read_event_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"low_quality",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted_due_to_muted_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"read_only",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trusted",storageKey:null}],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"DMConversationLabelInfo",kind:"LinkedField",name:"labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null}],storageKey:null},b={alias:null,args:null,concreteType:"SliceInfo",kind:"LinkedField",name:"slice_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"next_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"previous_cursor",storageKey:null}],storageKey:null},_={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:s,kind:"Operation",name:"DMPinnedInboxQuery",selections:[{alias:null,args:r,concreteType:"DMLabeledConversationsSlice",kind:"LinkedField",name:"labeled_conversation_slice",plural:!1,selections:[{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"items",plural:!0,selections:[l,i,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[o,{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[o,c,d,u,{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[l,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[y={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[y,{kind:"InlineFragment",selections:[l,i,p,{alias:null,args:null,filters:null,handle:"defaultScalars",key:"",kind:"LinkedHandle",name:"legacy"}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},m],storageKey:null},g],storageKey:null},b,_],storageKey:null},{alias:null,args:r,filters:["label","s"],handle:"slice",key:"DMPinnedInboxQuery_labeled_conversation_slice",kind:"LinkedHandle",name:"labeled_conversation_slice",handleArgs:[{kind:"Literal",name:"itemsFieldName",value:"items_results"}]}]},params:{id:"cKsXL-p1VWDQbomSDV2bAg",metadata:{sliceInfoPath:["labeled_conversation_slice","slice_info"]},name:"DMPinnedInboxQuery",operationKind:"query",text:null}};var s,r,l,i,o,c,d,u,h,p,m,g,b,_,y;n.hash="ce2e2976cf1d1610f3238a158593facf",t.default=n},YemM:function(e,t,a){"use strict";const n=a("rHpw").a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16,width:"100%"},active:{backgroundColor:e.colors.gray0},bodyColumn:{flexDirection:"row"},inlineTimestamp:{flexDirection:"row"},inlineTimestampVDL:{flexDirection:"row",alignItems:"center"},titleContainer:{flex:1},inlineNotificationsDisabledIcon:{paddingLeft:`calc(${e.spaces.space2} * 3)`,color:e.colors.gray700},inlineNotificationsDisabledIconVDL:{width:e.spaces.space16,height:e.spaces.space16},hiddenMenu:{opacity:0,overflow:"hidden",width:0},menu:{alignSelf:"flex-start"},menuContainer:{height:0,marginLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`},notificationsDisabledIcon:{alignSelf:"flex-end",color:e.colors.gray700,paddingTop:e.spaces.space4},unreadMessagePip:{backgroundColor:e.colors.blue500,marginTop:`calc(${e.spaces.space8} - ${e.spaces.space1})`,height:e.baseFontSize-5,width:e.baseFontSize-5},vdlXButton:{border:"none",marginLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`,marginRight:`calc(-1 * ${e.spaces.space4})`,marginTop:`calc(-1 * (${e.spaces.space8} - ${e.spaces.space1}))`},xButton:{alignSelf:"center",marginRight:`calc(-1 * ${e.spaces.space4})`},xIcon:{height:`calc(${e.spaces.space28} - ${e.spaces.space1})`,width:`calc(${e.spaces.space28} - ${e.spaces.space1})`},trashcanIcon:{color:e.colors.gray700},snippet:{maxHeight:e.spaces.space40,overflow:"hidden"},snippetPadding:{paddingRight:`calc(${e.spaces.space28} + ${e.spaces.space1} * 0.75)`},unread:{backgroundColor:e.colors.unreadCellBackground},socialProofContainer:{marginTop:e.spaces.space4},socialProofText:{marginLeft:0},convoLabelIcon:{marginRight:e.spaces.space4},endCell:{marginLeft:e.spaces.space16}})));t.a=n},ZH9U:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:s=[{defaultValue:null,kind:"LocalArgument",name:"conversation_id"},{defaultValue:null,kind:"LocalArgument",name:"label"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxAppend_Mutation",selections:r=[{alias:null,args:[{kind:"Variable",name:"conversation_id",variableName:"conversation_id"},{kind:"Variable",name:"label",variableName:"label"},{kind:"Literal",name:"s",value:18}],concreteType:null,kind:"LinkedField",name:"add_dm_conversation_label_v3",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],type:"DMConversationLabelInfo",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"failure_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"DMConversationLabelUnavailable",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:s,kind:"Operation",name:"DMPinnedInboxAppend_Mutation",selections:r},params:{id:"o0aymgGiJY-53Y52YSUGVA",metadata:{},name:"DMPinnedInboxAppend_Mutation",operationKind:"mutation",text:null}};var s,r;n.hash="86e5601441f8d07b68ccbcf112746d23",t.default=n},fQBn:function(e,t,a){"use strict";var n=a("ERkP"),s=a.n(n),r=a("t62R"),l=a("MMRb"),i=a("hqKg"),o=a("g54k"),c=a("G6rE"),d=a("rxPX");const u=(e,t)=>t.entry;var h=Object(d.a)().propsFromState((()=>({users:Object(i.createSelector)(c.e.selectAll,u,o.b)}))).adjustStateProps((({users:e})=>({...e}))),p=a("zQEV"),m=a("4n2h");var g=h((({entry:e,entryType:t,isSelected:a=!1,perspective:n,unread:l=!1,users:i})=>{const o=Object(p.a)(e,t,n,i),c=Object(m.b)(l),d=Object(m.a)(l,a);return s.a.createElement(r.b,{color:d,weight:c},o)})),b=a("v6aA"),_=a("oEGd");const y=Object(i.createSelector)(((e,t)=>c.e.select(e,t.senderId)),((e,t)=>t.recipientId?c.e.select(e,t.recipientId):void 0),((e,t)=>({user:e,recipient:t})));var v=Object(_.c)(y),E=a("X/yg"),f=a("cTG8"),S=a("3XMw"),I=a.n(S);const C=e=>s.a.createElement(I.a.I18NFormatMessage,{$i18n:"b3a2b11c"},s.a.createElement(r.b,null,e)),k=I.a.dedfd265;const x=I.a.a876e58b,w=I.a.bf584cd1,T=I.a.a9cc8cfd,M=I.a.e20b65b0,F=I.a.e5bfe07d,D=I.a.b1a614fe;var L=v((({entry:e,perspective:t,isGroupDM:a,unread:n=!1,user:l={},recipient:i={},isSelected:o=!1})=>{const{featureSwitches:c}=s.a.useContext(b.a),d=e&&e.message_data;if(!d)return null;const{attachment:u}=d,h=u&&!!(u.video||u.photo||u.animated_gif||u.tweet||u.fleet||u.sticker||u.card),p=t===l.id_str,g=!(!h||!p)||!(!a||p),_=l.name,y=i.name,v=Object(m.b)(n),S=Object(m.a)(n,o);let L=[g&&s.a.createElement(r.b,{key:"senderName"},C(_)," "),d&&d.text&&s.a.createElement(f.a,{displayTextRange:[0,d.text.length],entities:d.entities,key:"message",text:d.text,withMediaLinks:!0})];return u&&(u.tweet?L=g?((e,t)=>e?s.a.createElement(r.b,null,I.a.d5b762c8):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"dfd2b3b9"},s.a.createElement(r.b,null,t)))(p,_):D:u.fleet?L=((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"i005f1fd"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a||"")):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"b35cee40"},s.a.createElement(r.b,null,a||"")))(p,y,d.text):u.video?L=Object(E.l)(u,c)?g?function(e,t){return e?s.a.createElement(r.b,null,I.a.h7033cac):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"be5a9616"},s.a.createElement(r.b,null,t))}(p,_):k:g?((e,t)=>e?s.a.createElement(r.b,null,I.a.j7d81019):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"eee2f120"},s.a.createElement(r.b,null,t)))(p,_):x:u.photo?L=g?((e,t)=>e?s.a.createElement(r.b,null,I.a.f80629ba):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"c1e1f848"},s.a.createElement(r.b,null,t)))(p,_):w:u.animated_gif?L=g?((e,t)=>e?s.a.createElement(r.b,null,I.a.eb3d722e):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"dc4b75a1"},s.a.createElement(r.b,null,t)))(p,_):T:u.sticker?L=g?((e,t)=>e?s.a.createElement(r.b,null,I.a.d30c2d4f):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"c7e2464e"},s.a.createElement(r.b,null,t)))(p,_):M:u.card&&(L=g?((e,t)=>e?s.a.createElement(r.b,null,I.a.db53c017):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"hcbbbb34"},s.a.createElement(r.b,null,t)))(p,_):F)),s.a.createElement(r.b,{color:S,numberOfLines:1,weight:v},L)})),R=a("uKEd");const O=(e,t)=>t.senderId?c.e.select(e,t.senderId):void 0,P=(e,t)=>Object(R.n)(e,t.reactionEntry.message_id),N=(e,t)=>{const a=P(e,t);return a&&a.message_data&&c.e.select(e,a.message_data.sender_id)};var H=Object(_.e)((()=>Object(i.createSelector)(O,P,N,((e,t,a)=>({reactedMessageEntry:t,reactingUser:e,messageUser:a})))),{}),A=a("33Kz");var K=H((({isGroupDM:e,isSelected:t=!1,messageUser:a,perspective:n,reactedMessageEntry:l,reactingUser:i,reactionEntry:o,unread:c=!1})=>{const{featureSwitches:d}=s.a.useContext(b.a),u=l&&l.message_data,h=u&&u.attachment,p=u&&u.text,g=a&&a.screen_name,_=n===(i&&i.id_str),y=i&&i.name,v=Object(A.b)(o.reaction_key||"",d),E=Object(m.b)(c),f=Object(m.a)(c,t);let S;return S=h&&h.tweet?e?((e,t,a,n)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"c4202784"},s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"b493a890"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)))(_,y,g,v):((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"ca684bf5"},s.a.createElement(r.b,null,a)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"h5797be5"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a)))(_,y,v):h&&h.video?e?((e,t,a,n)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"d1f8bdd9"},s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"d764af97"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)))(_,y,g,v):((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"ab1cdfe2"},s.a.createElement(r.b,null,a)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"f0cf1699"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a)))(_,y,v):h&&h.photo?e?((e,t,a,n)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"hec0fd4d"},s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"j55320de"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)))(_,y,g,v):((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"jf27606a"},s.a.createElement(r.b,null,a)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"cd110359"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a)))(_,y,v):h&&h.animated_gif?e?((e,t,a,n)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"e70dcc35"},s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"g1bf440b"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)))(_,y,g,v):((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"b2da1bf8"},s.a.createElement(r.b,null,a)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"g84c0421"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a)))(_,y,v):h&&h.card?e?((e,t,a,n)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"cd2e7c18"},s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"aee9e7fa"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)))(_,y,g,v):((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"f9fb1cf6"},s.a.createElement(r.b,null,a)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"f2bf910e"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a)))(_,y,v):p?e?((e,t,a,n,l)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"i6cec545"},s.a.createElement(r.b,null,n),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,l)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"d6998baa"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,n),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,l)))(_,y,v,g,p):((e,t,a,n)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"cec676f3"},s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"a2706f9a"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a),s.a.createElement(r.b,null,n)))(_,y,v,p):((e,t,a)=>e?s.a.createElement(I.a.I18NFormatMessage,{$i18n:"d6b15bbf"},s.a.createElement(r.b,null,a)):s.a.createElement(I.a.I18NFormatMessage,{$i18n:"ac0d4bc7"},s.a.createElement(r.b,null,t),s.a.createElement(r.b,null,a)))(_,y,v),s.a.createElement(r.b,{color:f,numberOfLines:1,weight:E},S)})),B=a("H4nC"),U=a("b9JY");const j=I.a.fb3ccb55;t.a=({conversationType:e,entry:t,isSelected:a=!1,perspective:n,unread:i})=>{if(t.marked_as_spam){const e=Object(m.b)(i),t=Object(m.a)(i,a);return s.a.createElement(r.b,{color:t,numberOfLines:1,weight:e},j)}if(Object(U.b)(t)){const{message_data:{recipient_id:r,sender_id:o}={}}=t;return s.a.createElement(L,{entry:t,isGroupDM:e===l.CONVERSATION_TYPE.GROUP,isSelected:a,perspective:n,recipientId:r,senderId:o,unread:i})}return Object(U.c)(t)?s.a.createElement(K,{isGroupDM:e===l.CONVERSATION_TYPE.GROUP,isSelected:a,perspective:n,reactionEntry:t,senderId:t.sender_id,unread:i}):Object(U.a)(t)?s.a.createElement(g,{entry:t,entryType:t.type,isSelected:a,perspective:n,unread:i}):Object(U.d)(t)?s.a.createElement(B.a,{entry:t,isCompact:!0,isSelected:a,unread:i}):null}},fuhe:function(e,t,a){"use strict";a.r(t),a.d(t,"DMDrawer",(function(){return Xe}));var n=a("97Jx"),s=a.n(n),r=(a("kYxP"),a("ERkP")),l=a.n(r),i=a("ZUOq"),o=a("MMRb"),c=a("RqPI"),d=a("rxPX"),u=a("0KEI");var h=Object(d.a)().propsFromState((()=>({conversations:o.selectConversations,drawerExperimentEnabled:o.selectDrawerExperimentEnabled,perspective:c.q,poppedOutConversationId:o.selectPoppedOutConversationId,visibility:o.selectDrawerVisibility}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_CONVERSATION"),fetchInboxIfNeeded:o.fetchInboxIfNeeded,loadDrawerVisibilityFromPersistence:o.loadDrawerVisibilityFromPersistence,setDrawerVisibility:o.setDrawerVisibility}))),p=a("V/6K"),m=a("CDB5"),g=a("1YZw"),b=a("hqKg"),_=a("X/yg"),y=a("AQOc"),v=a("UhuB"),E=a("l0YN"),f=a("G6rE"),S=a("P1r1");const I=(e,t)=>t.conversationId,C=Object(b.createSelector)(((e,t)=>o.selectEntriesForConversation(e,I(0,t))),c.q,((e,t)=>t?Object(_.e)(e,t):void 0)),k=e=>t=>m.c(e,t),x=e=>(t,a)=>m.a(e,t,a),w={conversation:(e,t)=>o.selectConversation(e,I(0,t)),entries:o.selectEntries,perspective:c.q,users:f.e.selectAll,dataSaverMode:S.j,dtabBarInfo:S.m,quickReplyOptions:C,visibility:o.selectDrawerVisibility,inboxUnreadCount:E.a,isUnread:(e,t)=>!o.selectConversationIsRead(e,I(0,t)),isDmReceiptSettingEnabled:v.n},T={draftText:(e,t)=>m.l(e,I(0,t)),gifMetadata:(e,t)=>m.h(e,I(0,t)),isUploading:(e,t)=>m.j(e,I(0,t)),media:(e,t)=>m.i(e,I(0,t)),mediaUploadProgress:(e,t)=>m.k(e,I(0,t))};var M=Object(d.a)().propsFromState((()=>({...w,...T}))).adjustStateProps((({conversation:e,dataSaverMode:t,draftText:a,dtabBarInfo:n,entries:s,gifMetadata:r,inboxUnreadCount:l,isDmReceiptSettingEnabled:i,isUnread:o,isUploading:c,media:d,mediaUploadProgress:u,perspective:h,quickReplyOptions:p,users:m,visibility:g})=>{const b=null==e?void 0:e.data;return{conversation:b&&Object(y.a)(b,s,m),perspective:h,dataSaverMode:t,draftText:a,dtabBarInfo:n,gifMetadata:r,inboxUnreadCount:l,isDmReceiptSettingEnabled:i,isUploading:c,isUnread:o,media:d,mediaUploadProgress:u,quickReplyOptions:p,visibility:g}})).propsFromActions((({conversationId:e})=>({addMedia:x(e),addToast:g.b,createLocalApiErrorHandler:Object(u.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:o.fetchConversationHistory,removeMedia:k(e),saveText:m.f,sendMessage:m.m,updateConversationReadState:o.updateConversationReadState,updateTyping:o.updateTyping,fetchUpdatesIfNeeded:o.fetchUpdatesIfNeeded}))).withAnalytics({page:"messages",section:"thread_drawer"}),F=a("aWyx"),D=a("qz2E"),L=a("Oi4X"),R=a("OhSZ"),O=Object(d.a)().propsFromState((()=>({visibility:o.selectDrawerVisibility}))).propsFromActions((()=>({popOutConversation:o.popOutConversation,setDrawerVisibility:o.setDrawerVisibility}))).withAnalytics(),P=a("AQ79"),N=a("3XMw"),H=a.n(N),A=a("OrGc"),K=a("hACr"),B=a("fs1G"),U=a("MWbm"),j=a("/yvb"),V=a("Znyr"),z=a("t62R"),q=a("xKuM"),G=a("rHpw"),Q=a("v6aA"),$=a("95Se"),W=a("Avzu"),Y=a("Lsrn"),X=a("k/Ka");const Z=(e={})=>Object(X.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[Y.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M12 19.344l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 19.344z"}),l.a.createElement("path",{d:"M12 11.535l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 11.535z"})));Z.metadata={width:24,height:24};var J=Z;const ee=(e={})=>Object(X.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[Y.a.root,e.style],viewBox:"0 0 24 24"},l.a.createElement("g",null,l.a.createElement("path",{d:"M12 4.656l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0L12 4.656z"}),l.a.createElement("path",{d:"M12 12.465l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0l8.72-8.72z"})));ee.metadata={width:24,height:24};var te=ee,ae=a("x0mb");const ne=H.a.a2f8105f,se=H.a.d227d19e,re=H.a.c64c1883,le=H.a.j7d0e835,ie=H.a.b08821f3,oe=H.a.e736990a,ce=H.a.cdcebd22;class de extends l.a.Component{constructor(...e){super(...e),this._headerBar=l.a.createRef(),this._isExpanded=()=>{const{visibility:e}=this.props;return e===P.b.EXPANDED},this._renderLeftControl=()=>{const{inboxUnreadCount:e}=this.props;return l.a.createElement(U.a,null,l.a.createElement(j.a,{accessibilityLabel:ie,icon:l.a.createElement($.a,null),onPress:this._handleUnpopConvo,type:this._getButtonType()}),e&&e>0?l.a.createElement(V.a,{pip:!0,style:ue.newMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null)},this._getButtonType=()=>{const{hasNewMessages:e,isHighlighted:t}=this.props;return t&&e?"onMediaText":"primaryText"},this._renderRightControl=()=>{const{conversationTitle:e}=this.props,t=this._isExpanded(),a=this._getButtonType();return l.a.createElement(U.a,{style:ue.rightControls},e?null:l.a.createElement(j.a,{accessibilityLabel:re,hoverLabel:{label:ce},icon:l.a.createElement(W.a,null),onPress:this._handleNewMessage,type:a}),t?l.a.createElement(j.a,{accessibilityLabel:se,hoverLabel:{label:se},icon:l.a.createElement(J,null),onPress:this._handleToggleVisibility,type:a}):l.a.createElement(j.a,{accessibilityLabel:le,hoverLabel:{label:le},icon:l.a.createElement(te,null),onPress:this._handleToggleVisibility,type:a}))},this._handleUnpopConvo=()=>{const{popOutConversation:e}=this.props;e(null)},this._handleToggleVisibility=()=>{const{analytics:e,onDrawerOpen:t,setDrawerVisibility:a}=this.props,n=this._isExpanded()?P.b.COLLAPSED:P.b.EXPANDED;n===P.b.COLLAPSED?e.scribe({action:"collapse"}):n===P.b.EXPANDED&&(e.scribe({action:"expand"}),t&&t()),a(n)},this._handleToggleVisibilityKeyboard=()=>{this._handleToggleVisibility(),this._headerBar&&this._headerBar.current&&this._headerBar.current.focus()},this._handleNewMessage=()=>{const{analytics:e,history:t}=this.props;e.scribe({section:"compose_drawer",component:"dm",action:"show"}),t.push({pathname:"/messages/compose",state:{source:"drawer"}})},this._renderTitle=()=>{const{conversationTitle:e,hasNewMessages:t,isHighlighted:a}=this.props,n=e||l.a.createElement(z.b,null,ne);return l.a.createElement(U.a,{style:ue.titleContainer},l.a.createElement(U.a,{style:[ue.titleTextRoot,a&&t?ue.titleTextHighlighted:null]},n),t?l.a.createElement(U.a,{style:ue.newMessageDotContainer},l.a.createElement(ae.a,{accessibilityLabel:oe,style:[ue.newMessageDotRoot,a?ue.newMessageDotHighlighted:ue.newMessageDotRegular]})):null)}}componentDidUpdate(e){const{hasNewMessages:t,isHighlighted:a,triggerHighlight:n}=this.props;e.isHighlighted||a||e.hasNewMessages||!t||n&&n()}render(){const{conversationSubtitle:e,conversationTitle:t,hasNewMessages:a,isHighlighted:n}=this.props,s=a?n?[ue.headerHighlighted]:[ue.headerActive]:[],r=this._isExpanded();return l.a.createElement(K.a,{enabled:!0,handlers:{[A.e.goLists]:B.a,[A.e.toggleDMDrawer]:this._handleToggleVisibilityKeyboard}},l.a.createElement(U.a,{ref:this._headerBar,style:[ue.headerRoot,!r&&ue.headerBorderClosed,...s,ue.cursor]},l.a.createElement(q.a,{leftControl:t&&this._isExpanded()?this._renderLeftControl():null,onMiddleControlClick:this._handleToggleVisibility,rightControl:this._renderRightControl(),style:ue.roundedAppBarCorners,subtitle:e,title:this._renderTitle(),withBackground:!n})))}}de.contextType=Q.a;const ue=G.a.create((e=>({root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderColor:e.colors.borderColor,borderWidth:e.borderWidths.small,marginRight:e.spaces.space20,width:i.a.columnWidths.secondary.normal},cursor:{cursor:"pointer"},expanded:{height:i.a.columnWidths.secondary.normal},headerRoot:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,transition:"all 0.3s ease"},headerBorderClosed:{borderColor:e.colors.navigationBackground},headerActive:{backgroundColor:e.colors.unreadCellBackground},headerHighlighted:{borderColor:e.colors.primary,backgroundColor:e.colors.primary},titleContainer:{alignItems:"center",display:"flex",flexDirection:"row",flexGrow:1},titleTextRoot:{flexGrow:1,flexShrink:1},titleTextHighlighted:{color:e.colors.white},roundedAppBarCorners:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge},newMessageDotContainer:{flexGrow:1},newMessageDotRoot:{width:e.spaces.space12,height:e.spaces.space12,marginLeft:e.spaces.space4},newMessageDotRegular:{color:e.colors.primary},newMessageDotHighlighted:{color:e.colors.white},newMessagePip:{right:e.spaces.space4,top:e.spaces.space4},rightControls:{flexDirection:"row"}})));var he=O(de),pe=a("zb92");var me=Object(pe.a)({loader:()=>Promise.all([a.e(0),a.e(234)]).then(a.bind(null,"Rk1B"))}),ge=a("aWzz"),be=a("XnpN"),_e=a("GSsg"),ye=a("aITJ"),ve=a("yrzJ");class Ee extends l.a.Component{constructor(e,t){super(e,t),this._composer=l.a.createRef(),this._renderConversation=(e,t)=>{const{conversationId:a,history:n,location:s}=this.props;return l.a.createElement(L.a,{conversationId:a,drawerHeader:this._renderHeader(),history:n,isWide:!1,location:s,richTextInputContext:e,typeaheadWrapper:t})},this._isExpanded=()=>{const{visibility:e}=this.props;return e===P.b.EXPANDED},this._fetchUpdatesIfNeeded=()=>{const{conversationId:e,createLocalApiErrorHandler:t,fetchUpdatesIfNeeded:a,isDmReceiptSettingEnabled:n}=this.props;a(n?{active_conversation_id:e,dm_users:!0}:{}).catch(t())},Object(D.a)()}componentDidMount(){this._updatePolling()}componentDidUpdate(e){e.visibility!==this.props.visibility&&this._updatePolling()}render(){const e=this._isExpanded();return l.a.createElement(l.a.Fragment,null,!e&&this._renderHeader(),e?ye.b.isDesktopOS()?l.a.createElement(me,null,(({richTextInputContext:e,typeaheadWrapper:t})=>this._renderConversation(e,t))):this._renderConversation():null)}_renderHeader(){const{conversation:e,history:t,inboxUnreadCount:a,isHeaderHighlighted:n,isUnread:s,onDrawerOpen:r,perspective:i,triggerHeaderHighlight:o}=this.props,c=n?"white":"text",d=n?"white":"gray700",u=e&&e.type===F.a.ONE_TO_ONE&&i&&Object(be.a)(e,i).map((({user:e})=>e.screen_name)),h=u?l.a.createElement(ve.a,{color:d,screenName:u[0]}):void 0;return l.a.createElement(U.a,{style:fe.headerRoot},l.a.createElement(he,{conversationSubtitle:h,conversationTitle:l.a.createElement(R.b,{conversation:e,perspective:i,textColor:c,withScreenName:!1}),hasNewMessages:s,history:t,inboxUnreadCount:a,isHighlighted:n,onDrawerOpen:r,triggerHighlight:o}))}_updatePolling(){this._pollingTimer&&this._pollingTimer.stop(),this.props.visibility===P.b.COLLAPSED&&(this._pollingTimer=new _e.a(this._fetchUpdatesIfNeeded,{interval:3e3}),this._pollingTimer.start())}getChildContext(){return{getCustomLocation:null}}}Ee.contextType=Q.a,Ee.childContextTypes={getCustomLocation:ge.func};const fe=G.a.create((e=>({headerRoot:{position:"sticky",top:0,zIndex:e.componentZIndices.appBarZIndex}})));var Se=M(Ee),Ie=a("4q8G"),Ce=a("tn7R");var ke=Object(d.a)().propsFromState((()=>({conversations:o.selectConversations,settings:S.g,unreadCount:E.a,untrustedConversationCount:o.selectUntrustedConversationCount,untrustedUnreadCount:o.selectUntrustedUnreadCount,visibility:o.selectDrawerVisibility}))).adjustStateProps((({conversations:e,settings:t,unreadCount:a,untrustedConversationCount:n,untrustedUnreadCount:s,visibility:r})=>{const l=[];for(const t of Object(Ce.a)(e)){var i;!t.isDeleted&&null!=(i=t.data)&&i.trusted&&l.push(t.data)}l.sort(Ie.a);const o=a>0;return{allowUntrustedInbox:"all"===t.allow_dms_from||n>0,conversationIds:l.map((e=>e.conversation_id)),isUnread:o,untrustedUnreadCount:s,visibility:r}})).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX"),fetchInbox:o.fetchInbox,fetchInboxHistory:o.fetchTrustedInboxHistory,fetchInboxIfNeeded:o.fetchInboxIfNeeded,fetchUpdates:o.fetchUpdatesIfNeeded,updateLastSeenEventId:o.updateTrustedLastSeenEventId,popOutConversation:o.popOutConversation}))).withAnalytics({page:"messages",section:"inbox_drawer"}),xe=a("cFyg"),we=a("pXKu"),Te=a("nySH"),Me=a("yw4N"),Fe=a("FIs5"),De=a("csss");const Le=H.a.a2f8105f,Re=H.a.b8aa3744,Oe=H.a.j06309e1,Pe=H.a.gee5150a,Ne=H.a.cf2d1047,He=H.a.da2f9224,Ae=H.a.h6beb5fa;class Ke extends l.a.Component{constructor(...e){super(...e),this._renderHeader=()=>{const{history:e,isHeaderHighlighted:t,isUnread:a,onDrawerOpen:n,triggerHeaderHighlight:s}=this.props;return l.a.createElement(U.a,{style:Be.headerRoot},l.a.createElement(he,{hasNewMessages:a,history:e,isHighlighted:t,onDrawerOpen:n,triggerHighlight:s}))},this._renderExpandedInbox=()=>{const{analytics:e,conversationIds:t,fetchInboxHistory:a,updateLastSeenEventId:n}=this.props;return l.a.createElement(U.a,{style:Be.fill},l.a.createElement(U.a,{style:[Be.viewportView,xe.b.drawerHeaderRadius]},l.a.createElement(Me.a,{style:[Be.viewportView,xe.b.drawerHeaderRadius]},this._renderHeader(),l.a.createElement(we.a,{accessibilityTitle:Le,analytics:e,conversationIds:t,customCellClick:this._dmDrawerOnClick,fetchInboxHistory:a,isDrawer:!0,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderPivot,updateLastSeenEventId:n,virtualScrollerCacheKey:"dmDrawerInbox",withPinnedInbox:!0}))))},this._renderEmptyDMInbox=()=>l.a.createElement(l.a.Fragment,null,this._renderPivot(),l.a.createElement(Fe.a,{buttonLink:"/messages/compose",buttonText:Pe,header:Re,message:Oe,onImpression:this._handleEmptyDMInboxImpression})),this._isExpanded=()=>{const{visibility:e}=this.props;return e===P.b.EXPANDED},this._dmDrawerOnClick=(e,t)=>{const{popOutConversation:a}=this.props;a(t),e.preventDefault()},this._handleEmptyDMInboxImpression=()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})},this._handleRequestsPivotClick=()=>{const{analytics:e}=this.props;e.scribe({element:"requests_pivot",action:"click"})},this._renderPivot=()=>{const{allowUntrustedInbox:e}=this.props;return e?l.a.createElement(U.a,{style:Be.requestPivotContainer},l.a.createElement(De.a,{label:Ne,link:Object(Te.a)(P.d.SECONDARY),onPress:this._handleRequestsPivotClick,renderRightContent:this._renderPivotBadge})):null},this._renderPivotBadge=()=>{const{untrustedUnreadCount:e}=this.props;return e>0?l.a.createElement(V.a,{count:e,standalone:!0,truncatedCountFormatter:Ae,unreadCountLabel:He}):null}}componentDidUpdate(){this._isExpanded()&&Object(D.a)()}render(){const e=this._isExpanded();return l.a.createElement(l.a.Fragment,null,!e&&this._renderHeader(),e&&this._renderExpandedInbox())}}Ke.contextType=Q.a;const Be=G.a.create((e=>({fill:{flex:1,alignSelf:"stretch"},headerRoot:{position:"sticky",top:0,zIndex:e.componentZIndices.appBarZIndex},requestPivotContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:2},viewportView:{...G.a.absoluteFillObject,overflowY:"auto"}})));var Ue=ke(Ke),je=a("YeIG"),Ve=a("A69o"),ze="DMDrawer",qe=a("TnY3"),Ge=a("0FVZ"),Qe=a("Oe3h"),$e=a("nBUg");const We={isGlobal:!0,isSticky:!0},Ye={isGlobal:!0,isSticky:!1};class Xe extends l.a.PureComponent{constructor(...e){super(...e),this.state={isHeaderHighlighted:!1,hasStartedInitialFetch:!1,unexpandedHeight:void 0},this._handleLayout=e=>{const{nativeEvent:{layout:{height:t}}}=e,{unexpandedHeight:a}=this.state;this._isExpanded()||void 0!==a||this.setState({unexpandedHeight:t})},this._showDMDrawer=()=>{const{conversations:e,visibility:t}=this.props,a=t===P.b.CLOSED;return!this._isHideDMDrawerPath()&&!Object(je.a)(e)&&!a},this._isExpanded=()=>{const{visibility:e}=this.props;return e===P.b.EXPANDED},this._triggerHeaderHighlight=()=>{const{isHeaderHighlighted:e}=this.state;this._isExpanded()||e||this._headerHighlightTimeoutId||(this.setState({isHeaderHighlighted:!0}),this._headerHighlightTimeoutId=setTimeout((()=>{this.setState({isHeaderHighlighted:!1}),this._headerHighlightTimeoutId=void 0}),3e3))},this._handleDrawerOpen=()=>{const{isHeaderHighlighted:e}=this.state;e&&(this.setState({isHeaderHighlighted:!1}),clearTimeout(this._headerHighlightTimeoutId),this._headerHighlightTimeoutId=void 0)},this._isOnOcfFlow=()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/flow")},this._isOnBirdwatchPage=()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/birdwatch")},this._isHideDMDrawerPath=()=>this._isOnOcfFlow()||this._isOnBirdwatchPage()}componentWillUnmount(){clearTimeout(this._headerHighlightTimeoutId)}componentDidUpdate(){this._loadInboxDataIfNeeded()}componentDidMount(){this._loadInboxDataIfNeeded()}render(){const{history:e,location:t,perspective:a,poppedOutConversationId:n,width:r}=this.props,{isHeaderHighlighted:i,unexpandedHeight:o}=this.state,c=this._isExpanded();return this._showDMDrawer()?l.a.createElement(Ge.a.Drawer,null,l.a.createElement(Qe.a,{id:"DMDrawer"},((d,u)=>l.a.createElement(p.a.Provider,{value:{isDrawer:!0}},l.a.createElement($e.b.Provider,{value:{isDMDrawer:()=>!0}},l.a.createElement(U.a,s()({ref:d()},u({style:[xe.b.root,{width:r}],testID:ze})),l.a.createElement(U.a,{onLayout:o?void 0:this._handleLayout,style:[xe.b.expandable,{height:o,maxHeight:o},c&&xe.b.expanded]},n?l.a.createElement(Ve.a.Provider,{value:Ye},l.a.createElement(Se,{conversationId:n,history:e,isHeaderHighlighted:i,location:t,onDrawerOpen:this._handleDrawerOpen,perspective:a,triggerHeaderHighlight:this._triggerHeaderHighlight})):l.a.createElement(Ve.a.Provider,{value:We},l.a.createElement(Ue,{history:e,isHeaderHighlighted:i,onDrawerOpen:this._handleDrawerOpen,triggerHeaderHighlight:this._triggerHeaderHighlight}))))))))):null}_loadInboxDataIfNeeded(){const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:t,loadDrawerVisibilityFromPersistence:a}=this.props,{hasStartedInitialFetch:n}=this.state;this._isHideDMDrawerPath()||n||(a(),t().catch(e()),this.setState({hasStartedInitialFetch:!0}))}}Xe.defaultProps={width:i.a.dmDrawerWidth.max};const Ze=h(Xe);t.default=Object(qe.a)(Ze)},kb9v:function(e,t,a){"use strict";a("kYxP");var n=a("ERkP"),s=a.n(n),r=a("TIdA"),l=a("t62R"),i=a("A91F"),o=a("/yvb"),c=a("Eqye"),d=a("efqG"),u=a("sgih"),h=a("rHpw"),p=a("MWbm"),m=a("3dyc");const g=h.a.create((e=>({root:{paddingVertical:e.spacesPx.space32},rootWithImage:{paddingTop:0},graphic:{marginBottom:e.spacesPx.space20},icon:{alignSelf:"center",height:e.spacesPx.space64,width:e.spacesPx.space64},container:{paddingHorizontal:e.spacesPx.space32},description:{marginTop:e.spacesPx.space8,marginBottom:e.spacesPx.space4},actionButton:{marginTop:e.spacesPx.space16}})));t.a=({actionPrimary:e,actionSecondary:t,children:a,headline:n,icon:b,iconColor:_,imageUrl:y,onDismiss:v,shouldDisplay:E,text:f,withMask:S=!0})=>{const[I,C]=s.a.useState(!1),k=e=>s.a.createElement(d.a,{onDismiss:L,renderContent:()=>w(L),switchOnlyOnXSmallBreakpoint:!0,visibilityBehavior:m.b.forceVisible,withArrow:!0,withFixedPosition:!0,withMask:S},e),x=()=>s.a.createElement(u.a,{onMaskClick:()=>L(),type:"center",withMask:!0},w(L)),w=a=>s.a.createElement(p.a,{style:[g.root,y&&g.rootWithImage]},T(),s.a.createElement(p.a,{style:g.container},M(),F(),D({action:e,dismiss:a,type:t&&"primaryFilled"}),D({action:t,dismiss:a}))),T=()=>{let e=b&&s.a.createElement(b,{style:_?[g.icon,{color:h.a.theme.colors[_]}]:g.icon});return y&&!c.a.isEnabled&&(e=s.a.createElement(r.a,{accessibilityLabel:"",aspectMode:i.a.exact(2),image:y})),e&&s.a.createElement(p.a,{style:g.graphic},e)},M=()=>s.a.createElement(l.b,{size:"title3",weight:"heavy"},n),F=()=>s.a.createElement(l.b,{color:"gray700",style:g.description},f),D=({action:e,dismiss:t,type:a})=>e&&s.a.createElement(o.a,{link:e.link&&e.link,onPress:e.onClick?e.onClick:t,size:"large",style:g.actionButton,type:a},e.text),L=()=>{v&&v(),C(!0)};return E&&!I?a?k(a):x():a||null}},lBmi:function(e,t,a){"use strict";var n=a("ERkP"),s=a.n(n),r=a("Lsrn"),l=a("k/Ka");const i=(e={})=>Object(l.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[r.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M23.885 19.5c-.762-3.064-3.72-5.206-7.19-5.206-1.17 0-2.27.265-3.258.707 1.246 1.08 2.157 2.5 2.564 4.138.252 1.004.052 2.03-.52 2.86h6.48c.627 0 1.2-.27 1.57-.744.38-.49.51-1.13.355-1.753zm-9.695 1.755c.38-.49.512-1.13.356-1.754-.375-1.506-1.284-2.785-2.52-3.7-1.278-.95-2.905-1.507-4.67-1.507-3.47 0-6.428 2.142-7.19 5.208-.156.626-.025 1.266.356 1.755.37.473.94.744 1.567.744h10.533c.627 0 1.197-.272 1.567-.745zm2.505-8.218c1.185 0 2.51-.132 3.368-1.11.72-.823.952-2.08.715-3.847-.333-2.478-1.86-3.956-4.083-3.956-2.225 0-3.75 1.48-4.084 3.956-.235 1.766 0 3.023.718 3.846.858.98 2.184 1.11 3.368 1.11zm-9.34 0c1.185 0 2.51-.132 3.367-1.11.72-.823.953-2.08.716-3.847-.333-2.478-1.86-3.956-4.083-3.956-2.225 0-3.75 1.48-4.084 3.956-.235 1.766 0 3.023.718 3.846.858.98 2.184 1.11 3.368 1.11z"})));i.metadata={width:24,height:24},t.a=i},nySH:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return b}));var n=a("ERkP"),s=a.n(n),r=a("HPNB"),l=a("v6aA"),i=a("jYSG"),o=a("AQ79"),c=a("+Bsv"),d=a("MWbm"),u=a("cHvH"),h=a("t62R"),p=a("rHpw");const m=e=>{switch(e){case o.d.SECONDARY:return"/messages/requests";case o.d.TERTIARY:return"/messages/requests/additional";case o.d.PRIMARY:default:return"/messages"}},g=(e,t)=>s.a.createElement(l.a.Consumer,null,(({featureSwitches:a})=>{const n=a.isTrue("responsive_web_settings_revamp_enabled")?e:"/settings/safety";return s.a.createElement(c.a,{pullRight:t,to:n})})),b=e=>s.a.createElement(u.a,null,(({windowWidth:t})=>{const a=r.a.isTwoColumnLayout(t),n=0===e.length;return a||n?null:s.a.createElement(d.a,{style:_.stickyCopyContainer},s.a.createElement(h.b,{style:_.stickyCopy},i.a))})),_=p.a.create((e=>({stickyCopyContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:1},stickyCopy:{color:e.colors.gray700,padding:e.spaces.space20}})))},pXKu:function(e,t,a){"use strict";a("kYxP");var n=a("ERkP"),s=a.n(n),r=a("BUB3"),l=a("v6aA"),i=a("xZGM"),o=a("rxPX");var c=Object(o.a)().propsFromState((()=>({shouldShowPrompt:(e,t)=>Object(i.C)(e,i.k)}))).propsFromActions((()=>({addFlag:i.y}))).withAnalytics({component:"dm_education_flags_prompt"}),d=a("fs1G"),u=a("t62R"),h=a("feu+"),p=a("3XMw"),m=a.n(p);const g=m.a.fd6150fc,b=s.a.createElement(m.a.I18NFormatMessage,{$i18n:"iac7f92a"},s.a.createElement(u.b,{link:"/privacy"},m.a.d42d239f)),_=m.a.j24c37b2;var y=c((e=>{const{addFlag:t,analytics:a,shouldShowPrompt:n}=e,{featureSwitches:r}=s.a.useContext(l.a);if(!(n&&r.isTrue("dm_education_flags_prompt")))return!1;return a.scribeAction("impression"),s.a.createElement(h.a,{actionLabel:_,headline:g,onAction:()=>{a.scribeAction("click"),t(i.k)},onClose:d.a,subtext:b,withCloseButton:!1})})),v=a("MMRb"),E=a("kGix"),f=a("0KEI");var S=Object(o.a)().propsFromState((()=>({hasConversations:v.selectHasConversations,fetchStatus:v.selectFetchStatus,isLoadingTop:v.selectIsLoadingTop}))).adjustStateProps((({fetchStatus:e,hasConversations:t,isLoadingTop:a})=>({fetchStatus:t?E.a.LOADED:e,isRefreshing:t&&a}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(f.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX"),fetchInbox:v.fetchInbox,fetchInboxIfNeeded:v.fetchInboxIfNeeded,fetchUpdates:v.fetchUpdatesIfNeeded}))),I=(a("MvUL"),a("HPNB")),C=a("EbOo"),k=a("tZH3"),x=a("1YZw"),w=a("hqKg"),T=a("AQOc"),M=a("G6rE"),F=a("oEGd"),D=a("RqPI");const L=(e,t)=>t.conversationId,R=Object(w.createSelector)(L,((e,t)=>v.selectConversation(e,L(0,t))),v.selectEntries,M.e.selectAll,((e,t)=>!v.selectConversationIsRead(e,L(0,t))),((e,t)=>{const a=L(0,t);return Object(v.selectInboxTypeByConversation)(e,a)}),((e,t)=>Object(i.C)(e,i.s)),D.y,D.o,((e,t,a,n,s,r,l,i,o)=>({conversation:(null==t?void 0:t.data)&&Object(T.a)(t.data,a,n),conversationId:e,unread:s,inboxType:r,shouldShowPinnedEducation:l,reporterCountry:i,reporterLanguage:o}))),O={addFlag:i.y,addRecentSearch:v.addRecentSearches,addToast:x.b,block:M.e.block,createLocalApiErrorHandler:Object(f.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX_ITEM"),disableNotifications:v.disableNotifications,enableNotifications:v.enableNotifications,leaveConversation:v.leaveConversation,muteDMUser:v.muteDMUser,unmuteDMUser:v.unmuteDMUser,unblock:M.e.unblock};var P=Object(F.f)(R,O),N=a("aA19"),H=a("OhSZ"),A=a("V/6K"),K=a("fQBn"),B=a("Myq3"),U=a("3wZR"),j=a("XnpN"),V=a("aWyx"),z=a("YemM"),q="conversation",G=a("u0B7"),Q=a("MWbm"),$=a("Irs7"),W=a("eb3s"),Y=a("ZToW"),X=a("cHvH"),Z=a("lHOd"),J=a("kb9v"),ee=a("IG7M"),te=a("mjJ+"),ae=a("Znyr"),ne=a("0PHd"),se=a("yrzJ"),re=a("Xrkv"),le=a("efqG"),ie=a("/yvb"),oe=a("GBcw"),ce=a("cm6r"),de=a("htQn"),ue=a("5mJL"),he=a("vMjK"),pe=a("AQ79"),me=a("pHkl"),ge=a("X/yg"),be=a("Lsrn"),_e=a("k/Ka");const ye=(e={})=>Object(_e.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[be.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M17.931 2.508c0 .42-.34.75-.75.75h-8.39l1.38 2.08-.56 5.78-.47.16c-1.5.49-3.1 2.07-3.37 3.31-.07.35-.39.59-.73.59-.05 0-.11 0-.16-.01-.4-.09-.66-.49-.58-.89.39-1.81 2.24-3.52 3.91-4.25l.42-4.3-1.35-2.02c-.26-.38-.29-.87-.07-1.29.24-.41.66-.66 1.11-.66h8.86c.41 0 .75.34.75.75zm3.09 12.76c-.14.17-.46.46-1.05.46h-3.86l-2.64 6.1c-.12.28-.39.45-.69.45s-.57-.17-.69-.45l-1.96-4.53c-.16-.38.01-.82.39-.98.38-.17.82.01.99.39l1.27 2.93 1.69-3.91h-1.61c-.42 0-.75-.33-.75-.75 0-.41.33-.75.75-.75h6.81c-.41-1.06-1.64-2.26-2.91-2.82-.09-.04-.16-.09-.22-.16-.22-.21-.3-.54-.17-.83.17-.38.61-.55.99-.39 1.59.7 3.5 2.43 3.89 4.25.06.25.03.66-.23.99zm.839-12.259L3.2 21.659c-.15.15-.34.22-.53.22s-.39-.07-.53-.22c-.29-.29-.29-.76 0-1.06L20.8 1.939c.29-.29.76-.29 1.06 0 .29.3.29.77 0 1.07z"})));ye.metadata={width:24,height:24};var ve=ye,Ee=a("ShJ/");const fe=(e={})=>Object(_e.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[be.a.root,e.style],viewBox:"0 0 32 32"},s.a.createElement("g",null,s.a.createElement("path",{d:"M28.05 6.52h-5.42V4.887c0-1.548-1.26-2.808-2.81-2.808h-7.54c-1.548 0-2.807 1.26-2.807 2.808v1.63H4.05c-.414 0-.75.337-.75.75s.336.75.75.75h.753L7 26.435c.27 1.504 1.657 2.554 3.37 2.554h11.36c1.713 0 3.1-1.05 3.376-2.598l2.19-18.37h.753c.413 0 .75-.337.75-.75s-.336-.75-.75-.75zM10.972 4.887c0-.72.586-1.308 1.307-1.308h7.542c.72 0 1.308.587 1.308 1.308v1.63H10.972V4.89zm12.65 21.28c-.163.91-1.068 1.32-1.893 1.32H10.37c-.824 0-1.73-.41-1.887-1.276L6.313 8.02h19.472l-2.162 18.148z"}),s.a.createElement("path",{d:"M13.312 23.123c.414 0 .75-.336.75-.75v-9.6c0-.414-.336-.75-.75-.75s-.75.336-.75.75v9.6c0 .414.336.75.75.75zm5.486 0c.414 0 .75-.336.75-.75v-9.6c0-.414-.336-.75-.75-.75s-.75.336-.75.75v9.6c0 .414.336.75.75.75z"})));fe.metadata={width:32,height:32};var Se=fe,Ie=a("zIWA"),Ce=a("5pef"),ke=a("IpT4"),xe=a("5oT/"),we=a("fz3c");const Te=m.a.d88d0790,Me=m.a.ad63377d,Fe={confirmButtonLabel:m.a.bb1d57b6,actionTextLeave:m.a.g9074da4,header:m.a.gdf4b79f,text:m.a.h09b49f7},De=m.a.e1c9ec9b,Le=m.a.i6b19b07,Re=m.a.e3cfff7c,Oe=m.a.f398722d,Pe=m.a.a8ed0eca,Ne=m.a.jac4eb1e,He=m.a.bdd91963,Ae=m.a.a30a206d,Ke=m.a.ib4b1b85,Be=m.a.bd3ca2ee,Ue=e=>{var t;return Boolean(null==e||null==(t=e.labels)?void 0:t.find((e=>e.label_type===pe.a.PINNED)))},je={component:"low_quality_timeline"},Ve=({children:e})=>s.a.createElement(Q.a,{style:z.a.socialProofContainer},e);class ze extends s.a.Component{constructor(...e){super(...e),this._count=this.context.featureSwitches.getValue("dm_conversation_labels_max_pinned_count"),this._isPinnedEducationEnabled=this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_education_enabled"),this._isPinnedInboxEnabled=this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._isVDLEnabled=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),this.state={showActionMenu:!1,showConfirmation:!1,showPinnedAnnouncement:!1},this._renderConfirmationSheet=()=>{const{conversationId:e}=this.props;return s.a.createElement(W.a,{confirmButtonLabel:Fe.confirmButtonLabel,confirmButtonType:"destructiveFilled",headline:Fe.header,onCancel:this._handleHideConfirmation,onConfirm:this._deleteConversation(e),text:Fe.text})},this._renderMenu=({isFocused:e,isFocusedWithin:t,isHovered:a})=>{const{showActionMenu:n,showPinnedAnnouncement:r}=this.state,{conversation:l,position:i}=this.props,o=Ue(l),c=()=>{this.setState({showPinnedAnnouncement:!1})},d=()=>{this.setState({showActionMenu:!0})},u=this._isPinnedEducationEnabled&&r&&1===i&&!o,h=!Y.a.isEnabled||e||t||a||n||u;return s.a.createElement(A.a.Consumer,null,(({isDrawer:e})=>s.a.createElement(X.a,null,(({windowWidth:t})=>{const a=I.a.isTwoColumnLayout(t);return s.a.createElement(Z.a.Consumer,null,(t=>s.a.createElement(Q.a,{style:z.a.menuContainer},s.a.createElement(J.a,{actionPrimary:{text:Ae,onClick:c},headline:Ke,onDismiss:c,shouldDisplay:u&&!e,text:Be({count:this._count}),withMask:!a},a?s.a.createElement(ee.a,{onClick:d,renderActionMenu:this._renderActionMenu,style:h?z.a.menu:z.a.hiddenMenu}):null),a?null:s.a.createElement(ee.a,{onClick:d,renderActionMenu:this._renderActionMenu,style:h?z.a.menu:z.a.hiddenMenu}))))}))))},this._renderActionMenu=e=>{const{conversation:t,conversationId:a}=this.props,{history:n}=this.context,r=Ue(t),l=null==t?void 0:t.notifications_disabled,i=[];if(t){const e={Icon:r?ve:Ee.a,onClick:()=>this._handleTogglePinState(r),text:r?He:De,withBottomBorder:!0};i.push(e);const t={Icon:Se,isEmphasized:!0,onClick:this._handleDeleteMenuItemClick,text:Me,withBottomBorder:!0},s={Icon:Ie.a,onClick:()=>this._handleReportMenuItemClick(n)(),text:Le,withBottomBorder:!0},o={Icon:l?Ce.a:ke.a,onClick:()=>this._handleSnoozeMenuItemClick(a),text:l?Pe:Re,withBottomBorder:!0};i.push(s,o,t)}return s.a.createElement(te.a,{items:i,onCloseRequested:this._handleHideMenu(e),shouldCloseOnClick:!0})},this._renderConversationActions=({isFocused:e,isFocusedWithin:t,isHovered:a})=>{const{inboxType:n}=this.props;switch(n){case pe.d.PRIMARY:return this._isPinnedInboxEnabled?this._renderMenu({isFocused:e,isFocusedWithin:t,isHovered:a}):null;case pe.d.SECONDARY:case pe.d.TERTIARY:return this._renderX();default:return null}},this._renderConversationEndCell=e=>{const{inboxType:t,searchQuery:a,unread:n}=this.props,r=n?s.a.createElement(ae.a,{pip:!0,style:z.a.unreadMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null;switch(t){case pe.d.PRIMARY:return this._isVDLEnabled?r:a?null:this._renderTimestamp(e);case pe.d.SECONDARY:return this._isVDLEnabled?r:null;default:return null}},this._renderConversationLabel=({convo_label:e})=>{if(null==e||!e.text)return null;const t=Object(U.b)(e.icon);return s.a.createElement(u.b,{color:"gray700",size:"subtext2"},t?s.a.createElement(t,{style:z.a.convoLabelIcon}):null,e.text)},this._renderSocialProof=({social_proof:e})=>{if(!e||0===e.length)return null;const t=e[0];switch(t.proof_type){case V.d.MUTUAL_FRIENDS:{if(0===t.total)return null;const e=t.users.map((({profile_image_url_https:e})=>e)),a=t.users.map((({name:e})=>e));return s.a.createElement(Ve,null,s.a.createElement(u.b,{weight:this._isVDLEnabled?"medium":"normal"},s.a.createElement(ne.a,{displayFacepileInline:!0,knownFollowersAvatarUrls:e,knownFollowersCount:t.total,knownFollowersNames:a,textStyle:this._isVDLEnabled&&z.a.socialProofText,withFacepile:!this._isVDLEnabled})))}default:return null}},this._renderSearchConversationPreview=()=>{const{conversation:e,perspective:t,searchQuery:a}=this.props,n=e?Object(j.a)(e,t):[],r=[],l=(e,t)=>e.localeCompare(t),i=n.map((({user:e})=>e)).filter((e=>{var n;const s=null==(n=e.name)?void 0:n.toLowerCase().includes(a);return e.id_str!==t&&(s&&r.push(e.name),!s)})).map((e=>e.name)).sort(l),o=r.sort(l).concat(i);if(e){if(e.type===v.CONVERSATION_TYPE.ONE_TO_ONE){const[e]=n.map((({user:e})=>e));return s.a.createElement(se.a,{color:"gray700",screenName:e.screen_name})}{const e=!0,t=Object(re.a)(o,e);return s.a.createElement(u.b,{color:"gray700",numberOfLines:2},t)}}},this._renderX=()=>{const{conversation:e,conversationId:t}=this.props,{loggedInUserId:a}=this.context,n=Object(ge.j)(e,a),r=(null==e?void 0:e.type)===v.CONVERSATION_TYPE.GROUP;return s.a.createElement(Z.a.Consumer,null,(e=>s.a.createElement(le.a,{renderContent:(a,l)=>s.a.createElement(k.a,{dismiss:a,flatBorders:"sheet"===l,isGroup:r,onBlockClick:this._blockUser(n.idStr),onDeleteClick:this._deleteConversation(t),onReportClick:this._handleReportMenuItemClick(e),requestorScreenName:n.screenName,showBlock:!r,showCancel:"sheet"===l,showDelete:!0})},s.a.createElement(ie.a,{accessibilityLabel:Te,icon:s.a.createElement(xe.a,{style:this._isVDLEnabled?z.a.xIcon:void 0}),onPress:this._handleXPress,style:this._isVDLEnabled?z.a.vdlXButton:z.a.xButton,type:this._isVDLEnabled?void 0:"destructiveText"}))))},this._handleDeleteMenuItemClick=()=>{this.setState({showConfirmation:!0})},this._handleHideMenu=e=>()=>{e&&e(),this.setState({showActionMenu:!1})},this._getUserIdOfOneToOneConvo=()=>{const{conversation:e,perspective:t}=this.props,a=e&&Object(j.a)(e,t).map((({user:e})=>e)),n=a&&a[0]||null;return n?n.id_str:""},this._handleReportMenuItemClick=e=>()=>{const{analytics:t,conversation:a,conversationId:n,inboxType:s,reporterCountry:r,reporterLanguage:l}=this.props,i=we.a.DMConversation,{featureSwitches:o}=this.context,c=(null==a?void 0:a.type)===v.CONVERSATION_TYPE.GROUP?"0":this._getUserIdOfOneToOneConvo();if(n)if(t.scribeAction("report"),Object(we.g)(o,i,r,l)){const a=Object(we.d)({clientReferer:window.location.pathname,isMedia:!1,isPromoted:!1,reportType:i,reportedConversationId:n,reportedUser:c,scribeNamespace:t.contextualScribeNamespace});e.push({pathname:"/i/safety/report_story_start",state:{input:{requested_variant:JSON.stringify(a)}}})}else{const a=Object(ge.g)(n,window.location.pathname,t.contextualScribeNamespace,s);e.push(a)}},this._handleSnoozeMenuItemClick=e=>{const{addToast:t,analytics:a,conversation:n,disableNotifications:s,enableNotifications:r}=this.props;if(null==n?void 0:n.notifications_disabled)r({conversationId:e}).then(t({ariaOnly:!0,text:Ne}));else{const r=(null==n?void 0:n.participants.length)||0,l={conversation_type:(null==n?void 0:n.type)===v.CONVERSATION_TYPE.GROUP?me.i.GROUP:me.i.ONE_TO_ONE,conversation_id:e,conversation_participant_count:r,entry_point:me.c.THREE_DOT_MENU};a.scribe({element:"thread",action:"mute_dm_thread_forever",data:l}),s({conversationId:e}).then(t({ariaOnly:!0,text:Oe}))}},this._handleTogglePinState=e=>{const{analytics:t,conversation:a,conversationId:n,pinConversation:s,position:r,unpinConversation:l}=this.props,i=e?"unpin_dm_conversation":"pin_dm_conversation",o=e?l:s,c=(null==a?void 0:a.participants.length)||0,d={conversation_type:(null==a?void 0:a.type)===v.CONVERSATION_TYPE.GROUP?me.i.GROUP:me.i.ONE_TO_ONE,conversation_id:n,conversation_participant_count:c,position:r};t.scribe({element:"thread",action:i,data:d}),a&&o&&o(n,a)},this._handleXPress=e=>{e.preventDefault()},this._renderTimestamp=e=>{const{conversation:t,isMessageItem:a}=this.props,n=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),r=[n||a?z.a.inlineNotificationsDisabledIcon:z.a.notificationsDisabledIcon,n&&z.a.inlineNotificationsDisabledIconVDL],l=Number(e&&a?null==e?void 0:e.time:null==t?void 0:t.sort_timestamp);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Q.a,{style:[a&&z.a.inlineTimestamp,n&&z.a.inlineTimestampVDL]},t&&l?s.a.createElement(oe.a,{timestamp:l}):null,null!=t&&t.notifications_disabled?s.a.createElement(ke.a,{style:r}):null))},this._deleteConversation=e=>()=>{const{analytics:t,conversation:a,createLocalApiErrorHandler:n,inboxType:s,leaveConversation:r,position:l}=this.props,{history:i}=this.context,o=Ue(a),c=(null==a?void 0:a.participants.length)||0,d=a&&a.type===v.CONVERSATION_TYPE.GROUP?"leave_group":"delete_thread",u={conversation_type:(null==a?void 0:a.type)===v.CONVERSATION_TYPE.GROUP?me.i.GROUP:me.i.ONE_TO_ONE,conversation_id:e,conversation_participant_count:c,position:l,inbox_type:Object(ge.i)(s),entry_point:s===me.d.PRIMARY?me.c.THREE_DOT_MENU:me.c.CELL_X_BUTTON};this._handleHideConfirmation(),t.scribe({element:"thread",action:d,data:u}),o&&this._handleTogglePinState(o),r({conversationId:e}).catch(n({showToast:!0})),i.replace(Object(ge.f)(s))},this._blockUser=e=>()=>{const{addToast:t,analytics:a,block:n,createLocalApiErrorHandler:s}=this.props;n(e).then((()=>{t({action:{label:he.c,onAction:this._createUnblockUserHandler(e)},text:he.a})}),s(C.a)),a.scribeAction("block")},this._createUnblockUserHandler=e=>()=>{const{analytics:t,createLocalApiErrorHandler:a,unblock:n}=this.props;n(e).catch(a(G.a)),t.scribeAction("unblock")},this._handleHideConfirmation=()=>{this.setState({showConfirmation:!1})},this._handleOnClick=e=>{const{addRecentSearch:t,analytics:a,conversation:n,conversationId:s,onClick:r,position:l,searchQuery:i}=this.props,o=(null==n?void 0:n.participants.length)||0,c=(null==n?void 0:n.type)===v.CONVERSATION_TYPE.GROUP;i&&(a.scribe({component:"search",element:"conversation",action:"click",data:{conversation_id:s,conversation_participant_count:o,conversation_type:c?me.i.GROUP:me.i.ONE_TO_ONE,entry_point:me.c.ALL,inbox_type:me.d.PRIMARY,dm_search_result_type:me.a.CONVERSATION,message_type:me.e.NOT_APPLICABLE,position:l}}),a.scribe({component:"recent_search",action:"add"}),t(i)),r(e,s,n,l)},this._handleShowConfirmation=e=>{const{analytics:t}=this.props;e.stopPropagation(),t.scribe({...je,element:"accessory_trashcan",action:"click"}),this.setState({showConfirmation:!0})}}componentDidMount(){const{addFlag:e,shouldShowPinnedEducation:t}=this.props;t&&(this.setState({showPinnedAnnouncement:!0}),e(i.s))}shouldComponentUpdate(e,t){const a=this.props.conversation,n=null==a?void 0:a.conversation_id,s=null==a?void 0:a.notifications_disabled,r=null==a?void 0:a.last_read_event_id,l=null==a?void 0:a.sort_event_id,i=null==a?void 0:a.max_entry_id,o=null==a?void 0:a.convo_label,c=this.props.messageId,d=e.conversation,u=null==d?void 0:d.conversation_id,h=null==d?void 0:d.notifications_disabled,p=null==d?void 0:d.last_read_event_id,m=null==d?void 0:d.sort_event_id,g=null==d?void 0:d.max_entry_id,b=null==d?void 0:d.convo_label,_=e.messageId,{filter:y,isActive:v}=this.props,{filter:E,isActive:f}=e,{showConfirmation:S,showPinnedAnnouncement:I}=this.state,{showConfirmation:C,showPinnedAnnouncement:k}=t;return n!==u||s!==h||r!==p||l!==m||i!==g||c!==_||v!==f||S!==C||y!==E||o!==b||I!==k}render(){const{conversation:e,isActive:t,isMessageItem:a,link:n,messageId:r,perspective:l,position:i,searchQuery:o,unread:c}=this.props,{showConfirmation:d}=this.state,u=(null==e?void 0:e.entries)||[],h=a?u.find((e=>e.id===r)):Object(B.a)(u,(e=>!me.b.includes(e.type))),p=[z.a.root,c&&!this._isVDLEnabled&&z.a.unread,t&&this._isVDLEnabled&&z.a.active],m=(null==e?void 0:e.type)===v.CONVERSATION_TYPE.GROUP,g=this._isVDLEnabled&&m;if(!e)return null;const b=!!e.convo_label,_=!e.trusted&&!b,y=this._renderConversationEndCell(h),E=o&&!a;let f="text",S="bold";return this._isVDLEnabled&&!c&&(f="gray900",S="medium"),this._isVDLEnabled&&t&&(f="text",S="medium"),!e||!o&&e.isSearchResultOnly?null:s.a.createElement(s.a.Fragment,null,d?this._renderConfirmationSheet():null,s.a.createElement(ce.a,null,(({isFocused:r,isFocusedWithin:d,isHovered:u})=>s.a.createElement(de.a,{accessibilityRole:"none",accessibilityState:{selected:t},link:{pathname:null==n?void 0:n.pathname,anchorless:!0,state:{...null==n?void 0:n.state,position:i,entryPoint:a?null==h?void 0:h.id:null,isMessageItem:a}},onPress:this._handleOnClick,style:p,testID:q},s.a.createElement(ue.a,{avatarCell:s.a.createElement(N.a,{conversation:e,perspective:l,withBadge:g}),avatarSize:"xxLarge"},s.a.createElement(Q.a,{style:z.a.bodyColumn},s.a.createElement(Q.a,{style:z.a.titleContainer},s.a.createElement(H.b,{conversation:e,isConversationSearchTitle:!!E,isMessageSearchTitle:!!a,perspective:l,renderTimestamp:()=>this._renderTimestamp(h),textColor:f,titleWeight:S,withScreenName:!o&&!a,withVDLRefresh:this._isVDLEnabled}),s.a.createElement(Q.a,{style:[z.a.snippet,!r&&!d&&!u&&z.a.snippetPadding]},h&&!E?s.a.createElement(K.a,{conversationType:e.type,entry:h,isMessageItem:a,isSelected:this._isVDLEnabled&&t,perspective:l,unread:this._isVDLEnabled&&c}):E?this._renderSearchConversationPreview():null),b?this._renderConversationLabel(e):null,_?this._renderSocialProof(e):null),y?s.a.createElement(Q.a,{style:z.a.endCell},y):null,this._renderConversationActions({isFocused:r,isFocusedWithin:d,isHovered:u})))))))}}ze.contextType=l.a,ze.defaultProps={searchQuery:"",inboxType:"primary",isActive:!1,filter:e=>!0};var qe=Object($.a)(P(ze),{page:"messages",section:"inbox"});var Ge=Object(o.a)().propsFromState((()=>({pinnedConversationIds:v.selectPinnedConversationIds}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(f.createLocalApiErrorHandlerWithContextFactory)("DM_PINNED_INBOX_CONTEXT")}))).withAnalytics({page:"messages",section:"inbox"}),Qe=a("oUUt"),$e=a("rHpw");const We=m.a.b08821f3,Ye=m.a.e047b8fa,Xe=$e.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingLeft:e.spaces.space16,paddingVertical:e.spaces.space4,alignItems:"center",flexDirection:"row",justifyContent:"space-between",borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},backButton:{marginRight:e.spaces.space4},iconContainer:{alignItems:"center",flexDirection:"row"},icon:{color:e.colors.text,marginRight:e.spaces.space12,fontSize:e.fontSizes.body,marginVertical:e.spaces.space8},labelHeader:{borderBottomStyle:"none",paddingVertical:e.spaces.space12}})));var Ze=e=>{const t=Object($.b)(),{clearRecentSearches:a,headerText:n,icon:r,isInboxLabelHeader:l,withClearButton:i}=e;s.a.useEffect((()=>{t.scribe({component:"recent_search",action:"impression"})}),[t]);const o=[Xe.root,l&&Xe.labelHeader];return s.a.createElement(Q.a,{style:o},s.a.createElement(Q.a,{style:Xe.iconContainer},(()=>{const e=r;return e?s.a.createElement(e,{style:Xe.icon}):null})(),s.a.createElement(u.b,{accessibilityLevel:2,accessibilityRole:"heading",size:"headline1",weight:"heavy"},n)),i?s.a.createElement(ie.a,{accessibilityLabel:We,onPress:a,style:Xe.backButton,type:"onMediaWhiteFilled"},Ye):null)},Je=a("h3MB");a("Qavd");const et=(e,{module:t})=>t.selectItems(e),tt=(e,{module:t})=>t.selectFetchStatus(e);var at=Object(o.a)().propsFromState((()=>({fetchStatus:tt,sliceItems:et}))).adjustStateProps((({fetchStatus:e,sliceItems:t})=>{const a=(e=>{var t;return(null==(t=e.find((e=>e.groupData)))?void 0:t.groupData)||[]})(t),n=(e=>{var t;return(null==(t=e.find((e=>e.peopleData)))?void 0:t.peopleData)||[]})(t),s=(e=>{var t,a;return(null==(t=e.find((e=>e.messageData)))||null==(a=t.messageData)?void 0:a.conversationIds)||[]})(t);return{entryIds:(e=>{var t,a;return(null==(t=e.find((e=>e.messageData)))||null==(a=t.messageData)?void 0:a.entryIds)||[]})(t),fetchStatus:e,groupConversationIds:a,messageConversationIds:s,peopleSearchConversationIds:n,sliceItems:t}})).propsFromActions((({module:e})=>({createLocalApiErrorHandler:Object(f.createLocalApiErrorHandlerWithContextFactory)("DM_SEARCH_ALL_CONTEXT"),fetchSearchIfNeeded:e.fetchIfNeeded}))),nt=a("MDbM"),st=a("v//M"),rt=a("0yYu"),lt=a("lBmi"),it=a("91AQ"),ot=a("6ZHn");const ct=m.a.c94ac69d,dt=m.a.a2f8105f,ut=m.a.g2fd3205,ht=m.a.ffd9cfe6;class pt extends s.a.Component{constructor(...e){super(...e),this._groupBucketSize=this.context.featureSwitches.getNumberValue("dm_inbox_search_groups_bucket_size"),this._messagesBucketSize=this.context.featureSwitches.getNumberValue("dm_inbox_search_messages_bucket_size"),this._peopleBucketSize=this.context.featureSwitches.getNumberValue("dm_inbox_search_people_bucket_size"),this._renderSearchResults=()=>{const{groupConversationIds:e,messageConversationIds:t,peopleSearchConversationIds:a,renderEmptyState:n}=this.props,r=a.length&&e.length,l=this._groupBucketSize<e.length,i=this._messagesBucketSize<t.length,o=this._peopleBucketSize<a.length;return(null==e?void 0:e.length)||a.length||t.length?s.a.createElement(s.a.Fragment,null,a.length?this._renderPeopleSection():null,r&&!o?s.a.createElement(rt.a,null):null,o?this._renderDMSearchFooter(ut):null,e.length?this._renderGroupsSection():null,l?this._renderDMSearchFooter(ct):null,t.length?this._renderMessagesSection():null,i?this._renderDMSearchFooter(dt):null):n()},this._handleFetch=()=>{const{createLocalApiErrorHandler:e,fetchSearchIfNeeded:t}=this.props;t().catch(e())},this._renderDMSearchFooter=e=>{const{location:t}=this.props;return s.a.createElement(Q.a,{style:mt.header},s.a.createElement(u.b,{link:{pathname:t.pathname,state:{tab:e}}},ht))},this._renderDMHeader=({headerText:e,icon:t})=>s.a.createElement(Ze,{headerText:e,icon:t}),this._renderGroupsSection=()=>{const{groupConversationIds:e,pinConversation:t,renderInboxItem:a,unpinConversation:n}=this.props;return s.a.createElement(s.a.Fragment,null,this._renderDMHeader({icon:lt.a,headerText:ct}),e.map((s=>s?a({conversationIds:e,pinConversation:t,unpinConversation:n})(s):null)).slice(0,this._groupBucketSize))},this._renderMessagesSection=()=>{const{entryIds:e,messageConversationIds:t,pinConversation:a,renderInboxItem:n,unpinConversation:r}=this.props;return s.a.createElement(s.a.Fragment,null,this._renderDMHeader({icon:it.a,headerText:dt}),e.map((s=>s?(s=>n({conversationIds:t,isMessageItem:!0,messageIds:e,pinConversation:a,unpinConversation:r})(s))(s):null)).slice(0,this._messagesBucketSize))},this._renderPeopleSection=()=>{const{peopleSearchConversationIds:e,pinConversation:t,renderInboxItem:a,unpinConversation:n}=this.props;return s.a.createElement(s.a.Fragment,null,this._renderDMHeader({icon:ot.a,headerText:ut}),e.map((s=>s?a({conversationIds:e,pinConversation:t,unpinConversation:n})(s):null)).slice(0,this._peopleBucketSize))}}componentDidUpdate(e){const{fetchStatus:t,module:a}=this.props;e.module!==a&&t!==nt.a.FAILED&&this._handleFetch()}componentDidMount(){this._handleFetch()}render(){const{fetchStatus:e,loadingLabel:t}=this.props;return s.a.createElement(st.a,{accessibilityLabel:t,fetchStatus:e,onRequestRetry:this._handleFetch,render:this._renderSearchResults})}}pt.contextType=l.a;const mt=$e.a.create((e=>({header:{backgroundColor:e.colors.cellBackground,paddingLeft:e.spaces.space16,paddingVertical:e.spaces.space12,alignItems:"center",flexDirection:"row",justifyContent:"space-between",borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,borderTopStyle:"solid",borderTopWidth:e.borderWidths.small,borderTopColor:e.colors.borderColor}})));var gt=at(pt),bt=a("wAC9"),_t=a("xPna");const yt=(e,t=!0)=>{const a={};let n={};return null!=e&&e.conversations&&(Object.values(e.conversations).forEach((e=>{e&&e.users&&Object.assign(a,e.users),t&&(e.isSearchResult=!0)})),n={conversations:null==e?void 0:e.conversations,users:a}),null!=e&&e.entries&&(n={...n,entries:null==e?void 0:e.entries}),Object(_t.a)(n)};var vt=e=>Object(bt.a)({contextSuffix:"DM_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMAllSearch,sliceKey:`${me.g}-${e}`,getEndpointParams:t=>({...t,query:e}),mapEntitiesToActions:yt});const Et=(e,t)=>t.query;var ft=Object(o.a)().propsFromState((()=>({sliceModule:Object(w.createSelector)(Et,(e=>e?vt(e):void 0))})))((e=>{const{loadingLabel:t,location:a,pinConversation:n,query:r,renderEmptyState:l,renderInboxItem:i,sliceModule:o,unpinConversation:c}=e;return o?s.a.createElement(gt,{loadingLabel:t,location:a,module:o,pinConversation:n,query:r,renderEmptyState:l,renderInboxItem:i,unpinConversation:c}):l()}));const St=v.selectRecentSearches,It=(e,t)=>t.query?v.selectSearchConversations(e,t.query):[],Ct=(e,t)=>t.query?v.selectSearchFetchStatus(e,t.query):E.a.LOADED,kt=(e,t)=>t.conversationIds||[],xt=(e,t)=>null!=e&&e.length?t.filter((t=>e.indexOf(t)>-1)):e;var wt=Object(o.a)().propsFromState((()=>({conversationIds:kt,recentSearches:St,searchFetchStatus:Ct,searchConversationIds:It}))).adjustStateProps((({conversationIds:e,recentSearches:t,searchConversationIds:a,searchFetchStatus:n})=>({conversationIds:e,recentSearches:t,searchFetchStatus:n,searchConversationIds:xt(a,e)}))).propsFromActions((()=>({addRecentSearch:v.addRecentSearches,createLocalApiErrorHandler:Object(f.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_SEARCH"),search:v.searchConversations,clearRecentSearch:v.clearRecentSearch,clearRecentSearches:v.clearRecentSearches}))),Tt=a("VY6S"),Mt=a("s14A");var Ft=e=>Object(bt.a)({contextSuffix:"DM_GROUP_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMGroupSearch,sliceKey:`${me.g}-groups-${e}`,getEndpointParams:t=>({...t,query:e}),mapEntitiesToActions:yt});var Dt=e=>Object(bt.a)({contextSuffix:"DM_PEOPLE_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMPeopleSearch,sliceKey:`${me.g}-people-${e}`,getEndpointParams:t=>({...t,query:e}),mapEntitiesToActions:yt});const Lt=(e,t)=>t.query,Rt=(e,t)=>t.tabType;var Ot=Object(o.a)().propsFromState((()=>({sliceModule:Object(w.createSelector)(Rt,Lt,((e,t)=>{const a=t&&e===me.h.PEOPLE;return t&&e===me.h.GROUPS?Ft(t):a?Dt(t):void 0}))}))),Pt=a("FS1z");var Nt,Ht=Ot((e=>{const{footer:t,onScrollEnd:a,pinConversation:n,renderEmptyState:r,renderInboxItem:l,sliceModule:i,unpinConversation:o}=e;return i?s.a.createElement(Pt.a,{footer:t,module:i,noItemsRenderer:r,onScrollEnd:a,renderer:l({conversationIds:[],pinConversation:n,unpinConversation:o}),withoutHeadroom:!0}):r()})),At=a("VPW4"),Kt=(a("enFi"),a("mN6z")),Bt=a("TEoO"),Ut=a("NjAB"),jt=a("Fr3L"),Vt=a("uDfI"),zt=a("DQzJ");const qt=void 0!==Nt?Nt:Nt=a("y59G"),Gt="DM_MESSAGE_SEARCH",Qt={context:Gt},$t=e=>e,Wt=e=>{var t;const{footer:a,noItemsRenderer:n,onScrollEnd:r,pinConversation:l,renderInboxItem:i,searchTerm:o,unpinConversation:c}=e,d=Object(Vt.c)(),{data:u,fetchNext:h,hasNext:p}=Object(zt.a)(qt,{query:o}),{entities:m,normalizedConversations:g,normalizedMessages:b}=s.a.useMemo((()=>{var e,t,a;const n=null==u||null==(e=u.dm_message_slice_result)||null==(t=e.items)?void 0:t.map((e=>{var t,a;return null==e||null==(t=e.dm_event)||null==(a=t.legacy)?void 0:a.conversation})),s=null==u||null==(a=u.dm_message_slice_result)?void 0:a.items,r=Object(Ut.b)(n,[Je.a]),l=Object(Ut.b)(s,[Je.b]);return{normalizedConversations:r,normalizedMessages:l,entities:{...null==r?void 0:r.entities,...null==l?void 0:l.entities}}}),[null==u||null==(t=u.dm_message_slice_result)?void 0:t.items]),_=(e=>{const t=s.a.useRef();return s.a.useEffect((()=>{t.current=e})),t.current})(u);return s.a.useEffect((()=>{Object(Kt.a)(u,_)||d(yt(m,!0))}),[m,u,_,d]),s.a.createElement(Bt.a,{cacheKey:Gt,footer:p?null:a,identityFunction:$t,items:null==b?void 0:b.result,noItemsRenderer:n,onNearEnd:h,onScrollEnd:r,renderer:i({conversationIds:null==g?void 0:g.result,isMessageItem:!0,messageIds:null==b?void 0:b.result,pinConversation:l,unpinConversation:c}),withoutHeadroom:!0})},Yt=$e.a.create((e=>({activityIndicatior:{paddingVertical:250}})));function Xt(e){return s.a.createElement(jt.a,{errorConfig:Qt},s.a.createElement(s.a.Suspense,{fallback:s.a.createElement(At.a,{style:Yt.activityIndicatior})},s.a.createElement(Wt,e)))}var Zt=a("j7Bv"),Jt=a("VwDm"),ea=a("hOZg");const ta=m.a.dbd5d40f;class aa extends s.a.PureComponent{render(){const{clearRecentSearch:e,handleRecentSearchClick:t,recentSearch:a}=this.props,n=s.a.createElement(Zt.a,{Icon:Jt.a,color:"neutral",size:"xLarge",style:na.searchIcon}),r=[na.listItemView,na.bottomBorder];return s.a.createElement(de.a,{onPress:t,style:r},s.a.createElement(Q.a,null,s.a.createElement(ue.a,{avatarCell:n,avatarSize:"xLarge",cellStyle:na.avatarColumn},s.a.createElement(Q.a,{style:na.container},s.a.createElement(u.b,{numberOfLines:1},a),s.a.createElement(ie.a,{accessibilityLabel:ta,borderColor:"transparent",icon:s.a.createElement(ea.a,null),onPress:e,type:"brandText"})))))}}const na=$e.a.create((e=>({container:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},searchIcon:{marginRight:e.spaces.space12,padding:e.spaces.space4},avatarColumn:{flexGrow:1,minWidth:"32px"},bottomBorder:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},listItemView:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space12,width:"100%"}})));var sa=aa,ra=a("DbJc"),la=a("IG4P"),ia=a("RJrc"),oa=a("TnY3"),ca=a("FIs5"),da=a("6OUF"),ua=a("k/OQ"),ha=a("95Se");const pa=e=>e,ma=m.a.b08821f3,ga=m.a.a66ac766,ba=m.a.fe61929d,_a=m.a.a846382a,ya=m.a.b9dae4f4,va=m.a.e7fb2027,Ea=m.a.b92a21d8,fa=m.a.jdc67c42,Sa=m.a.e8581ccd,Ia=m.a.f08940ab,Ca=m.a.gaae1fd5,ka=m.a.f8321d82,xa=m.a.c94ac69d,wa=m.a.a2f8105f,Ta=m.a.g2fd3205,Ma=m.a.fb3c8e74;class Fa extends s.a.Component{constructor(...e){super(...e),this.state={debouncedQuery:"",isLoadingMore:!1,isRefreshing:!1},this._messageSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_message_results_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._modularSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_modular_results_enabled"),this._setInputRef=e=>{this._textInputRef=e},this._renderEmptyDMSearchInbox=()=>{const{analytics:e,query:t}=this.props,{debouncedQuery:a}=this.state;return a&&t?(e.scribe({component:"search",element:"results",action:"empty"}),s.a.createElement(ca.a,{buttonLink:"/messages/compose",buttonText:Ia,header:Ea({query:a}),message:this._messageSearchEnabled?Sa:fa,onButtonPress:this._handleComposeButtonPress})):s.a.createElement(Q.a,{style:Da.emptyState},s.a.createElement(u.b,{align:"center",color:"gray700"},Ca))},this._renderRecentSearches=()=>{const{analytics:e,query:t,recentSearches:a}=this.props;return a.length&&!t?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{analytics:e,clearRecentSearches:this._clearRecentSearches,headerText:Ma,withClearButton:!0}),a.map((e=>s.a.createElement(sa,{clearRecentSearch:t=>this._handleClearRecentSearch(t,e),handleRecentSearchClick:()=>this._handleRecentSearchClick(e),key:e,recentSearch:e})))):this._renderEmptyDMSearchInbox()},this._renderAllDMSearchResultsTab=()=>{const{location:e,pinConversation:t,renderInboxItem:a,unpinConversation:n}=this.props,{debouncedQuery:r}=this.state;return r?s.a.createElement(ft,{loadingLabel:ga,location:e,pinConversation:t,query:r,renderEmptyState:this._renderEmptyDMSearchInbox,renderInboxItem:a,unpinConversation:n}):this._renderEmptyDMSearchInbox()},this._renderConversationsTab=e=>{const{pinConversation:t,renderInboxItem:a,unpinConversation:n}=this.props,{debouncedQuery:r}=this.state;return s.a.createElement(Ht,{footer:this._renderFooter(),onScrollEnd:this._handleScrollEnd,pinConversation:t,query:r,renderEmptyState:this._renderEmptyDMSearchInbox,renderInboxItem:a,tabType:e?me.h.GROUPS:me.h.PEOPLE,unpinConversation:n})},this._renderMessagesTab=()=>{const{pinConversation:e,renderInboxItem:t,unpinConversation:a}=this.props,{debouncedQuery:n}=this.state;return n?s.a.createElement(Xt,{footer:this._renderFooter(),noItemsRenderer:this._renderEmptyDMSearchInbox,onScrollEnd:this._handleScrollEnd,pinConversation:e,renderInboxItem:t,searchTerm:n,unpinConversation:a}):this._renderEmptyDMSearchInbox()},this._renderTabContent=()=>{const{location:e}=this.props,{tab:t}=(null==e?void 0:e.state)||{};switch(t){case Ta:return this._renderConversationsTab(!1);case xa:return this._renderConversationsTab(!0);case wa:return this._renderMessagesTab();default:return this._renderAllDMSearchResultsTab()}},this._renderSearchResults=()=>{const{accessibilityTitle:e,pinConversation:t,renderInboxItem:a,searchConversationIds:n,unpinConversation:r}=this.props,{isRefreshing:l}=this.state;return s.a.createElement(Mt.a,null,s.a.createElement(la.a,{isRefreshing:l,onRefresh:this._handlePullToRefresh},s.a.createElement(Bt.a,{accessibilityRole:"tablist",accessibilityTitle:e,anchoring:ra.a,assumedItemHeight:100,cacheKey:"dmSearchInbox",footer:this._renderFooter(),identityFunction:pa,items:n,noItemsRenderer:this._renderRecentSearches,onNearEnd:this._handleNearEnd,onScrollEnd:this._handleScrollEnd,renderer:a({conversationIds:n,pinConversation:t,unpinConversation:r}),withoutHeadroom:!0})))},this._renderFooter=()=>this.state.isLoadingMore?s.a.createElement(ia.a,null):s.a.createElement(Q.a,{style:Da.footerContainer},s.a.createElement(u.b,{align:"center",size:"body",weight:"bold"},va),s.a.createElement(ce.a,{interactiveStyles:null},s.a.createElement(u.b,{align:"center",color:"primary",onPress:this._handleFooterClick,size:"subtext2",withInteractiveStyling:!0},ya))),this._clearRecentSearches=()=>{const{analytics:e,clearRecentSearches:t}=this.props;e.scribe({component:"recent_search",action:"clear"}),t()},this._handleComposeButtonPress=()=>{const{analytics:e}=this.props;e.scribe({component:"search",element:"empty_results",action:"compose"})},this._handleFooterClick=()=>{var e,t;null==(e=this._textInputRef)||e.clear(),null==(t=this._textInputRef)||t.focus()},this._handleRefetchSearch=()=>{const{analytics:e,createLocalApiErrorHandler:t,search:a}=this.props,{debouncedQuery:n}=this.state;a&&n&&(e.scribe({component:"search",element:"retry",action:"click"}),a({query:n.toLowerCase(),preserveResults:!1,fetchNextPage:!1}).catch(t()))},this._handlePullToRefresh=()=>{const{createLocalApiErrorHandler:e,search:t}=this.props,{debouncedQuery:a}=this.state;this.setState({isRefreshing:!0}),t&&a&&t({query:a.toLowerCase(),preserveResults:!0,fetchNextPage:!1}).then((()=>this.setState({isRefreshing:!1}))).catch((t=>(this.setState({isRefreshing:!1}),e()(t))))},this._handleSearchChangeInner=e=>{const{createLocalApiErrorHandler:t,onQueryChange:a,search:n}=this.props;a(e),this.setState({debouncedQuery:e}),n&&e&&!this._modularSearchEnabled&&n({query:e,preserveResults:!1,fetchNextPage:!1}).catch(t())},this._handleSearchChangeDebounced=Object(Tt.a)(this._handleSearchChangeInner,200),this._handleSearchChange=({currentTarget:{value:e}})=>{const{onQueryChange:t}=this.props;(e&&e.trim()||!e)&&(t(e),this._handleSearchChangeDebounced(e))},this._handleNearEnd=()=>{const{analytics:e,search:t}=this.props,{debouncedQuery:a}=this.state;this.setState({isLoadingMore:!0}),a&&(e.scribe({component:"search",element:"results",action:"get_older"}),t({query:a,preserveResults:!1,fetchNextPage:!0}).finally((()=>this.setState({isLoadingMore:!1}))))},this._handleScrollEnd=()=>{const{addRecentSearch:e,analytics:t,query:a}=this.props,{debouncedQuery:n}=this.state;n&&a&&(e(a),t.scribe({component:"recent_search",action:"add"}))},this._handleSearchClear=()=>this._handleSearchChangeInner(""),this._handleHideRecentSearches=()=>{const{hideRecentSearches:e}=this.props;e()},this._handleAddRecentSearch=({currentTarget:{value:e}})=>{const{addRecentSearch:t,analytics:a}=this.props;e&&(t(e),a.scribe({component:"recent_search",action:"add"}),this._textInputRef&&this._textInputRef.blur())},this._handleRecentSearchClick=e=>{const{analytics:t,onQueryChange:a}=this.props;a(e),t.scribe({component:"recent_search",action:"click"}),this._handleSearchChangeInner(e)},this._handleClearRecentSearch=(e,t)=>{const{analytics:a,clearRecentSearch:n}=this.props;e.stopPropagation(),e.preventDefault(),a.scribe({component:"recent_search",action:"clear"}),n(t)}}componentDidMount(){this._textInputRef&&this._textInputRef.focus()}componentDidUpdate(e){const{analytics:t,query:a,recentSearches:n}=this.props;e.query||!a||n.includes(a)||t.scribe({component:"search",action:"began_typing"})}render(){const{location:e,query:t,searchFetchStatus:a}=this.props,n=!(this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled")||this._modularSearchEnabled&&t),r=[Da.searchInput,n?Da.searchInputBorder:void 0],{tab:l}=(null==e?void 0:e.state)||{},i=[ka,Ta,xa];this._messageSearchEnabled&&i.push(wa);const o=i.map((t=>({key:t,label:t,accessibilityLabel:t,isActive:()=>l===t||!l&&t===ka,to:{...e,state:{...e.state,tab:t}}}))),c=l===wa&&this._messageSearchEnabled;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Q.a,{style:r},s.a.createElement(ie.a,{accessibilityLabel:ma,icon:s.a.createElement(ha.a,null),onPress:this._handleHideRecentSearches,pullLeft:!0,type:"primaryText"}),s.a.createElement(da.a,{Icon:Jt.a,autoComplete:"off",onChange:this._handleSearchChange,onClear:this._handleSearchClear,onSubmitEditing:this._handleAddRecentSearch,placeholder:this._messageSearchEnabled?_a:ba,ref:this._setInputRef,value:t,withClearButton:!0})),this._modularSearchEnabled&&(t||l===Ta||l===xa||c)?s.a.createElement(s.a.Fragment,null,s.a.createElement(ua.a,{links:o}),this._renderTabContent()):s.a.createElement(st.a,{accessibilityLabel:ga,fetchStatus:a,onRequestRetry:this._handleRefetchSearch,render:this._renderSearchResults}))}}Fa.contextType=l.a,Fa.defaultProps={recentSearches:[],searchConversationIds:[],query:""};const Da=$e.a.create((e=>({emptyState:{marginTop:e.spaces.space32},searchInput:{backgroundColor:e.colors.cellBackground,padding:e.spaces.space12,flexDirection:"row",alignItems:"center",zIndex:1},searchInputBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small},footerContainer:{marginVertical:e.spaces.space32}})));var La=Object(oa.a)(wt(Fa)),Ra=a("UIzd"),Oa=a.n(Ra),Pa=a("OIs+");const Na=m.a.cb367657,Ha=m.a.ie9a7e48,Aa=m.a.hd3927c6,Ka=m.a.f1ac0968,Ba={[Pa.a.Offline]:{toast:{text:Ha}},defaultToast:{text:Na},showToast:!0},Ua={[Pa.a.Offline]:{toast:{text:Ka}},defaultToast:{text:Aa},showToast:!0};var ja,Va,za,qa=a("9SqB"),Ga=a.n(qa),Qa=a("Ud88"),$a=a.n(Qa);const Wa=m.a.e4b3f520,Ya=m.a.ae4d666a,Xa=e=>e,Za=m.a.a219e217,Ja=m.a.d571e4f8,en=m.a.a551bf7d,tn=m.a.d98e066b,an=m.a.j302dba7,nn=void 0!==ja?ja:ja=a("X8um"),sn={context:"DM_PINNED_INBOX"},rn=e=>{var t;const n=Object(Vt.c)(),{accessibilityTitle:r,analytics:i,cacheKey:o,conversationIds:c,createLocalApiErrorHandler:d,footer:u,header:h,onNearEnd:p,pinnedConversationIds:m,renderEmptyDMInbox:g,renderInboxItem:b,showSearchView:_,withKeyboardShortcuts:y}=e,E=$a()(),{data:f}=Object(zt.a)(nn,{label:pe.a.PINNED}),S=(null==f||null==(t=f.labeled_conversation_slice)?void 0:t.items)||[],{entities:I}=Object(Ut.b)(S,[Je.a]),{featureSwitches:C}=s.a.useContext(l.a),k=C.getValue("dm_conversation_labels_max_pinned_count"),[w,T]=s.a.useState(!1),[M,F]=s.a.useState(!1),D=(e=>{const t=s.a.useRef();return s.a.useEffect((()=>{t.current=e})),t.current})(f);s.a.useEffect((()=>{var e;const t=(null==D||null==(e=D.labeled_conversation_slice)?void 0:e.items)||[],a=null==t?void 0:t.filter((e=>-1===S.indexOf(e.rest_id)));a.length&&a.forEach((e=>{var t;const a=null==(t=e.labels)?void 0:t.filter((e=>e.label_type!==pe.a.PINNED));n(yt({conversations:{[e.rest_id]:{...e,labels:a}}}))})),n(yt(I,!1))}),[f]);const[L]=Ga()(void 0!==Va?Va:Va=a("ZH9U")),[R]=Ga()(void 0!==za?za:za=a("rQjK")),O=(e,t)=>{L({variables:{conversation_id:e,label:pe.a.PINNED},onCompleted(a){var s;switch(null==(s=a.add_dm_conversation_label_v3)?void 0:s.__typename){case"DMConversationLabelInfo":{const{label_type:s,timestamp:r}=a.add_dm_conversation_label_v3;n(yt({conversations:{[e]:{...t,labels:[{label_type:s,timestamp:r}]}}})),n(Object(x.b)({ariaOnly:!0,text:tn}));break}case"DMConversationLabelUnavailable":{const{failure_reason:e}=a.add_dm_conversation_label_v3;i.scribe({element:"thread",action:"error_shown",data:{error_type:me.f.MAX_PINS_REACHED}}),"ExceededMaxPinnedConversations"===e&&F(!0);break}}},onError(e){d(Ba)(e)}})},P=(e,t)=>{R({variables:{conversation_id:e,label_type:pe.a.PINNED},onCompleted(a){var s;const r=t?null==t||null==(s=t.labels)?void 0:s.filter((e=>e.label_type!==pe.a.PINNED)):[];n(yt({conversations:{[e]:{...t,labels:r}}})),n(Object(x.b)({ariaOnly:!0,text:an}))},updater(t){var a,n;const s=null==(a=S.find((t=>t.rest_id===e)))?void 0:a.id,r=null==f||null==(n=f.labeled_conversation_slice)?void 0:n.__id;if(!s||!r)return;const l=t.get(s),i=t.get(r);i&&l&&(Object(Qe.b)(i,s),t.delete(s))},onError(e){d(Ua)(e)}})},N=null==c?void 0:c.filter((e=>-1===m.indexOf(e))),H=m.length&&N.length,A=s.a.createElement(s.a.Fragment,null,h,null!=m&&m.length?s.a.createElement(s.a.Fragment,null,ln(Wa),m.map(((e,t)=>b({conversationIds:m,pinConversation:O,unpinConversation:P})(e)))):null,H?ln(Ya):null);return null!=c&&c.length?s.a.createElement(s.a.Fragment,null,M?s.a.createElement(W.a,{confirmButtonLabel:Za,headline:Ja({count:k}),onConfirm:()=>F(!1),text:en,withCancelButton:!1}):null,_?s.a.createElement(La,{accessibilityTitle:r,analytics:i,conversationIds:c,hideRecentSearches:e.hideRecentSearches,onQueryChange:e.onQueryChange,pinConversation:O,query:e.query,renderInboxItem:e.renderInboxItem,unpinConversation:P}):s.a.createElement(la.a,{isRefreshing:w,onRefresh:()=>{T(!0);const e=Oa()(E,nn,{label:pe.a.PINNED}).toPromise();Promise.all([e,()=>n(v.fetchInbox())]).then((()=>T(!1))).catch((e=>{d()(e),T(!1)}))}},o&&null!=N&&N.length?s.a.createElement(Bt.a,{accessibilityRole:"tablist",accessibilityTitle:r,anchoring:ra.a,assumedItemHeight:100,cacheKey:o,footer:u,header:A,identityFunction:Xa,items:N,onNearEnd:p,renderer:b({conversationIds:N,pinConversation:O,unpinConversation:P}),withKeyboardShortcuts:y,withoutHeadroom:!0}):A)):g()},ln=e=>s.a.createElement(Q.a,null,s.a.createElement(Ze,{headerText:e,isInboxLabelHeader:!0}));var on=Ge((function(e){return s.a.createElement(jt.a,{errorConfig:sn},s.a.createElement(rn,e))})),cn=a("dwig"),dn=a("QB0K"),un=a("Avzu"),hn=a("FRNI");const pn=m.a.h845f281,mn=m.a.f325afc3;function gn(){return s.a.createElement(dn.a,{accessibilityLabel:pn,href:"/messages/compose",icon:s.a.createElement(un.a,null),label:pn,scribeComponent:"floating_dm_button",shortLabel:mn,testID:hn.a.message})}var bn=s.a.memo(gn),_n=a("tI3i"),yn=a.n(_n),vn=a("sNn6"),En=a("883S"),fn=a("yoO3"),Sn=a("GSsg"),In=a("2g+p"),Cn=a("mw9i"),kn=a("BcsE"),xn=a("+d3d");const wn=e=>e,Tn=m.a.a66ac766,Mn=m.a.fe61929d,Fn=m.a.a846382a;class Dn extends s.a.Component{constructor(e,t){super(e,t),this.state={showSearchView:!1,searchQuery:""},this._enablePinnedInbox=this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._messageSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_message_results_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1"),this._modularSearchEnabled=this.context.featureSwitches.isTrue("dm_inbox_search_modular_results_enabled"),this._isVDLEnabled=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),this._render=()=>{const{withPinnedInbox:e}=this.props;return this._enablePinnedInbox&&e?this._renderPinnedInbox():this._renderInbox()},this._renderFocusedSearch=()=>{const{accessibilityTitle:e,analytics:t,conversationIds:a}=this.props,{searchQuery:n}=this.state;return s.a.createElement(La,{accessibilityTitle:e,analytics:t,conversationIds:a,hideRecentSearches:this._hideRecentSearches,onQueryChange:this._handleQueryChange,query:n,renderInboxItem:this._renderInboxItem})},this._renderInbox=()=>{const{accessibilityTitle:e,conversationIds:t,footer:a,isDrawer:n,isRefreshing:r,renderEmptyDMInbox:l,virtualScrollerCacheKey:i}=this.props,{showSearchView:o}=this.state;return o?this._renderFocusedSearch():s.a.createElement(la.a,{isRefreshing:r,onRefresh:this._handlePullToRefresh},i&&t?s.a.createElement(Bt.a,{accessibilityRole:"tablist",accessibilityTitle:e,anchoring:ra.a,assumedItemHeight:100,cacheKey:i,footer:a,header:this._renderHeader(),identityFunction:wn,items:t,noItemsRenderer:l,onNearEnd:this._handleNearEnd,renderer:this._renderInboxItem({conversationIds:t}),withKeyboardShortcuts:!n,withoutHeadroom:!0}):null)},this._handleNearEnd=()=>{this._handleHistoryRequest()},this._handleQueryChange=e=>{this.setState({searchQuery:e})},this._handleSearchChange=({currentTarget:{value:e}})=>{this.state.showSearchView||this.setState({showSearchView:!0})},this._handleSearchClick=()=>{const{analytics:e}=this.props;e.scribe({component:"search",action:"click"}),this.setState({showSearchView:!0})},this._hideRecentSearches=()=>{this.setState({showSearchView:!1,searchQuery:""})},this._renderInboxItem=({conversationIds:e,isMessageItem:t=!1,messageIds:a,pinConversation:n,unpinConversation:l})=>(i,o)=>{const{loggedInUserId:c}=this.context,{location:d}=this.props,{searchQuery:u}=this.state,h=t?(a||[]).indexOf(i):-1,p=-1!==h&&null!=e&&e.length?e[h]:null,m=p?i:"",g=p||i,b={pathname:`/messages/${g}`,state:{...null==d?void 0:d.state,entryPoint:null}},_=g&&null!=e&&e.length?e.indexOf(g):null,y=Object(kn.a)(_)?_+1:0;yn()(!!c,"loggedInUserId must be defined"),o&&o(!0);const v=e=>s.a.createElement(qe,{conversationId:g,inboxType:this.props.inboxType,isActive:e,isMessageItem:t,key:g,link:b,messageId:m,onClick:this._handleConversationClick,perspective:c,pinConversation:n,position:y,searchQuery:u,unpinConversation:l});return this._isVDLEnabled?s.a.createElement(vn.a,{exact:!1,path:b.pathname},v):s.a.createElement(r.a,{exact:!1,path:b.pathname},v)},this._renderPinnedInbox=()=>{const{accessibilityTitle:e,conversationIds:t,footer:a,isDrawer:n,renderEmptyDMInbox:r,virtualScrollerCacheKey:l}=this.props,{searchQuery:i,showSearchView:o}=this.state;return t.length?s.a.createElement(on,{accessibilityTitle:e,cacheKey:l,conversationIds:t,footer:a,header:this._renderHeader(),hideRecentSearches:this._hideRecentSearches,onNearEnd:this._handleNearEnd,onQueryChange:this._handleQueryChange,query:i,renderEmptyDMInbox:r,renderInboxItem:this._renderInboxItem,showSearchView:o,withKeyboardShortcuts:!n}):r()},this._handleFetchInitialWrapper=()=>{this._handleFetchInitial()},this._handleFetchInitial=()=>{const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:t,fetchUpdates:a}=this.props;return t().then(this._updateLastSeenEventId,e()).then((()=>{this._updatePolling.start()})).then((()=>a().catch(e())))},this._handleConversationClick=(e,t,a,n)=>{const{analytics:s,customCellClick:r}=this.props,l=(null==a?void 0:a.participants.length)||0,i=(null==a?void 0:a.type)===v.CONVERSATION_TYPE.GROUP;s.scribe({element:"thread",action:"click",data:{event_value:this.state.searchQuery.length,conversation_id:t,conversation_participant_count:l,conversation_type:i?me.i.GROUP:me.i.ONE_TO_ONE,position:n}}),r&&r(e,t)},this._handleEmptyDMInboxImpression=()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})},this._handlePullToRefresh=()=>{const{createLocalApiErrorHandler:e,fetchInbox:t}=this.props;t().then(this._updateLastSeenEventId,e())},this._updateLastSeenEventIdIfActive=()=>{if("background"!==In.a.currentState)return this._updateLastSeenEventId()},this._renderHeader=()=>{const{renderStickyContent:e,withDmSearch:t}=this.props,a=[Ln.searchInput,this._isVDLEnabled?void 0:Ln.searchInputBorder];return s.a.createElement(s.a.Fragment,null,t?s.a.createElement(Q.a,{onClick:this._handleSearchClick,style:a},s.a.createElement(da.a,{Icon:Jt.a,autoComplete:"off",isCompact:!0,onChange:this._handleSearchChange,placeholder:this._messageSearchEnabled?Fn:Mn,withClearButton:!0})):null,e?e():null)},this._updateLastSeenEventId=()=>{const{createLocalApiErrorHandler:e,updateLastSeenEventId:t}=this.props;return t().catch(e())},this._fab=s.a.createElement(bn,null)}componentDidMount(){const{createLocalApiErrorHandler:e,fetchInboxHistory:t,fetchUpdates:a}=this.props;return this._updatePolling=new Sn.a((()=>{a().then(this._updateLastSeenEventIdIfActive,e(En.a))}),{interval:8e3}),this._handleHistoryRequest=Object(xn.a)(((...a)=>{t(...a).catch(e())}),1e3),this._handleFetchInitial()}componentWillUnmount(){this._updatePolling.stop()}render(){return s.a.createElement(fn.a,null,s.a.createElement(y,null),s.a.createElement(cn.a,{component:Cn.a,fab:this._fab,style:Ln.root},s.a.createElement(st.a,{accessibilityLabel:Tn,fetchStatus:this.props.fetchStatus,onRequestRetry:this._handleFetchInitialWrapper,render:this._render})))}}Dn.contextType=l.a,Dn.defaultProps={conversationIds:[],inboxType:pe.d.PRIMARY,isDrawer:!1,withDmSearch:!1,withPinnedInbox:!1};const Ln=$e.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,flexGrow:1},searchInput:{backgroundColor:e.colors.cellBackground,padding:e.spaces.space12,zIndex:1},searchInputBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:"1px"}})));t.a=Object(oa.a)(S(Dn))},rQjK:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:s=[{defaultValue:null,kind:"LocalArgument",name:"conversation_id"},{defaultValue:null,kind:"LocalArgument",name:"label_type"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxDelete_Mutation",selections:r=[{alias:null,args:[{kind:"Variable",name:"conversation_id",variableName:"conversation_id"},{kind:"Variable",name:"label_type",variableName:"label_type"}],kind:"ScalarField",name:"dm_conversation_label_delete",storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:s,kind:"Operation",name:"DMPinnedInboxDelete_Mutation",selections:r},params:{id:"_TQxP2Rb0expwVP9ktGrTQ",metadata:{},name:"DMPinnedInboxDelete_Mutation",operationKind:"mutation",text:null}};var s,r;n.hash="f0ba5e0b671c54ae94c7322d3036a375",t.default=n},y59G:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:s=[{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:null,kind:"LocalArgument",name:"query"}],kind:"Fragment",metadata:null,name:"DMMessageSearchTabQuery",selections:[{alias:"dm_message_slice_result",args:[r={kind:"Variable",name:"query",variableName:"query"},l={kind:"Literal",name:"s",value:19}],concreteType:null,kind:"LinkedField",name:"__DMMessageSearchTabQuery_dm_message_slice_result_slice",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"items",plural:!0,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DMEvent",kind:"LinkedField",name:"dm_event",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DMEventMetadata",kind:"LinkedField",name:"legacy",plural:!1,selections:[c={alias:null,args:null,kind:"ScalarField",name:"affects_sort",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"created_at_millis",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"request_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"event_id",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"event_type",storageKey:null},{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[o,i,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[m={alias:null,args:null,kind:"ScalarField",name:"conversation_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[m,g={alias:null,args:null,kind:"ScalarField",name:"conversation_type",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"created_by_user_results",plural:!1,selections:v=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[o,i,y={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[b,_={alias:null,args:null,kind:"ScalarField",name:"screen_name",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"admin_user_results",plural:!1,selections:v,storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[o,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[E={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"original_img_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_height",storageKey:null}],type:"ApiImage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[o,i,f={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id_str",storageKey:null},b,_,{alias:null,args:null,kind:"ScalarField",name:"profile_image_url_https",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"last_read_event_id",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"join_time_millis",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"join_conversation_event_id",storageKey:null}],storageKey:null},k={alias:null,args:null,concreteType:"PerspectivalConversationMetadata",kind:"LinkedField",name:"perspectival_conversation_metadata",plural:!1,selections:[S,{alias:null,args:null,kind:"ScalarField",name:"low_quality",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted_due_to_muted_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"read_only",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trusted",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DMEventDetail",kind:"LinkedField",name:"event_detail",plural:!1,selections:[x={alias:null,args:null,concreteType:"DMInitialLowQualityState",kind:"LinkedField",name:"initial_low_quality_state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_low_quality",storageKey:null}],storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"is_new_one_to_one_convo",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"is_spam_hide",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"marked_as_abuse",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},b,D={alias:null,args:null,kind:"ScalarField",name:"possibly_spam",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"sender_registration_token",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"users_results",plural:!0,selections:v,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"participants_snapshot_results",plural:!0,selections:v,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"initiating_user_results",plural:!1,selections:v,storageKey:null},{alias:null,args:null,concreteType:"DirectMessageInfo",kind:"LinkedField",name:"dm",plural:!1,selections:[R={alias:null,args:null,kind:"ScalarField",name:"created_at_sec",storageKey:null},o,O={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"recipient_results",plural:!1,selections:v,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"sender_results",plural:!1,selections:v,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMMessageSearchItem",abstractKey:null}],storageKey:null},P={alias:null,args:null,concreteType:"SliceInfo",kind:"LinkedField",name:"slice_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"next_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"previous_cursor",storageKey:null}],storageKey:null}],type:"DMMessageSlice",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:s,kind:"Operation",name:"DMMessageSearchTabQuery",selections:[{alias:null,args:N=[{kind:"Variable",name:"cursor",variableName:"cursor"},r,l],concreteType:null,kind:"LinkedField",name:"dm_message_slice_result",plural:!1,selections:[H={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"items",plural:!0,selections:[H,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DMEvent",kind:"LinkedField",name:"dm_event",plural:!1,selections:[i,o,{alias:null,args:null,concreteType:"DMEventMetadata",kind:"LinkedField",name:"legacy",plural:!1,selections:[c,d,u,h,p,{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[o,i,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[m,g,b,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"created_by_user_results",plural:!1,selections:K=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[H,{kind:"InlineFragment",selections:[o,i,y,A={alias:null,args:null,filters:null,handle:"defaultScalars",key:"",kind:"LinkedHandle",name:"legacy"}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"admin_user_results",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[o,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[H,E],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[H,{kind:"InlineFragment",selections:[o,i,f,A],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},S,I,C],storageKey:null},k],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DMEventDetail",kind:"LinkedField",name:"event_detail",plural:!1,selections:[x,w,T,M,F,b,D,L,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"users_results",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"participants_snapshot_results",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"initiating_user_results",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"DirectMessageInfo",kind:"LinkedField",name:"dm",plural:!1,selections:[R,o,O,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"recipient_results",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"sender_results",plural:!1,selections:K,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMMessageSearchItem",abstractKey:null}],storageKey:null},P],type:"DMMessageSlice",abstractKey:null}],storageKey:null},{alias:null,args:N,filters:["query","s"],handle:"slice",key:"DMMessageSearchTabQuery_dm_message_slice_result",kind:"LinkedHandle",name:"dm_message_slice_result"}]},params:{id:"bbdRrkndYmyQHx463K9HSA",metadata:{sliceInfoPath:["dm_message_slice_result","slice_info"]},name:"DMMessageSearchTabQuery",operationKind:"query",text:null}};var s,r,l,i,o,c,d,u,h,p,m,g,b,_,y,v,E,f,S,I,C,k,x,w,T,M,F,D,L,R,O,P,N,H,A,K;n.hash="f240afda618da0d5e047ef48ee76dd56",t.default=n}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.DMDrawer.1eb25925.js.map